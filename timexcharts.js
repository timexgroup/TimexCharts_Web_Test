!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.timexcharts=e():t.timexcharts=e()}(self,(()=>(()=>{"use strict";var t={856:(t,e,a)=>{a.r(e);const r={USE_12HR_FORMAT:0,USE_24HR_FORMAT:1},i={ONE_SECOND:86400,ONE_MINUTE:1440,FIVE_MINUTES:288,TEN_MINUTES:144,FIFTEEN_MINUTES:96,TWENTY_MINUTES:72,THIRTY_MINUTES:48,ONE_HOUR:24};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function s(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:String(e)}const l=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startTime=e,this.stepCount=a}var e,a;return e=t,(a=[{key:"stepCount",get:function(){return this._stepCount},set:function(t){this._stepCount=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}}])&&n(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),h={ENGLISH:"en",SPANISH:"es",SYSTEM_LANGUAGE:"sys"};function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function d(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function f(t,e,a){return(e=y(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function y(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:String(e)}const m=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"processBarClick",(function(t,e){var r=e[0];if(r){a.chart.data;var i=a.chart.options.plugins,o=i.customToolTip,n=i.customCursorTracker;(!1===o.enabled||!0===o.enabled&&o.barIndex===r.index)&&(o.enabled=!o.enabled,n.enabled=!n.enabled),o.barIndex=r.index,a.chart.update()}})),f(this,"customCursorTrackerHandler",(function(t,e,r){if(!0===r.enabled){t.ctx,t.canvas;var i=t.scales.x,o=t.scales.y,n=t.chartArea,s=(n.top,n.right,n.bottom,n.left,i.getValueForPixel(e.event.x));a.defdata.datasets[0].data[s]>0&&o.getValueForPixel(e.event.y)>0&&(a.chart.options.plugins.customToolTip.barIndex=s)}})),f(this,"customToolTipHandler",(function(t,e,r){if(!0===r.enabled){var i=t.ctx,o=(t.canvas,t.scales.x),n=t.scales.y,s=t.chartArea,l=(s.top,s.right,s.bottom),h=(s.left,a.chart.options.plugins.customToolTip.barIndex);i.save();var c,u=a.defdata.datasets[0].data[h],d=o.getPixelForValue(h)-170,f=155,y=65,m=n.getPixelForValue(u);c=m+20>=l?m:m+20,m+y>t.height&&(m=t.height-y),i.fillStyle=r.backgroundColor,i.strokeStyle=r.backgroundColor,i.beginPath(),i.moveTo(d+f-5,m+y),i.arcTo(d,m+y,d,m,5),i.arcTo(d,m,d+f,m,5),i.arcTo(d+f,m,d+f,m+y,5),i.arcTo(d+f,m+y,d+f-5,m+y,5),i.closePath(),i.stroke(),i.fill(),i.beginPath(),i.moveTo(d+155,c),i.lineTo(d+165,c+10),i.lineTo(d+155,c+20),i.closePath(),i.stroke(),i.fill(),i.font="24pt",i.fillStyle="white",i.textAlign="left",i.fillText(a.convertTimeToTimeFormat(a.convertIndexToTime(h)),d+5,m+20),i.fillText(a.getLocalizedStepCountString(a.language),d+5,m+40),i.fillText(a.getLocalizedTotalStepsString(a.language),d+5,m+55),i.textAlign="right",i.fillText("".concat(u),d+f-5,m+40),i.fillText("".concat(a.totalSteps),d+f-5,m+55),i.restore()}})),this.ctx=e,this.barColor="#3EB1C8",this.timeFormat=r.USE_12HR_FORMAT,this.maxIntervalCount=i.ONE_SECOND,this.intervalUsed=i.ONE_SECOND,this.displayIntervalCount=i.FIFTEEN_MINUTES,this.language=h.ENGLISH,this.defdata={labels:[""],datasets:[{data:[0],backgroundColor:this.barColor,borderColor:this.barColor,hoverBackgroundColor:this.barColor,borderWidth:0,barPercentage:1,categoryPercentage:1}]};var o={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{maxTicksLimit:24,callback:function(t,e,a){return a.length,""}}},y:{display:!1,beginAtZero:!0}},plugins:{tooltip:{enabled:!1},legend:{display:!1},customXAxisBackground:{enabled:!0,label1:"12:00 AM",label2:"12:00 PM",label3:"11:59 PM"},customCursorTracker:{enabled:!1},customToolTip:{enabled:!1,barIndex:0,backgroundColor:"rgba(51, 51, 51, 0.9)"}},onClick:this.processBarClick}};this.addCustomPlugins(),this.chart=new Chart(this.ctx,o)}var e,a;return e=t,(a=[{key:"addCustomPlugins",value:function(){Chart.register({id:"customXAxisBackground",beforeDraw:this.customXAxisBackgroundHandler}),Chart.register({id:"customCursorTracker",afterEvent:this.customCursorTrackerHandler}),Chart.register({id:"customToolTip",afterDatasetsDraw:this.customToolTipHandler})}},{key:"customXAxisBackgroundHandler",value:function(t,e,a){var r=t.ctx,i=t.scales.x;r.save(),r.fillStyle="rgba(237, 239, 240, 1.0)",r.fillRect(0,t.chartArea.bottom,i.width,30),r.fillStyle="black",r.textAlign="center",r.fillText(a.label1,t.chartArea.left+30,t.chartArea.bottom+15),r.fillText(a.label2,i.width/2,t.chartArea.bottom+15),r.fillText(a.label3,t.chartArea.right-30,t.chartArea.bottom+15),r.restore()}},{key:"convertIndexToTime",value:function(t){var e=0;switch(this.displayIntervalCount){case i.ONE_SECOND:e=Math.floor(t/60);break;case i.ONE_MINUTE:e=1*t;break;case i.FIVE_MINUTES:e=5*t;break;case i.TEN_MINUTES:e=10*t;break;case i.FIFTEEN_MINUTES:e=15*t;break;case i.TWENTY_MINUTES:e=20*t;break;case i.THIRTY_MINUTES:e=30*t;break;case i.ONE_HOUR:e=60*t;break;default:t=0}var a=e%60;return Math.floor(e/60)+":"+(a<10?"0":"")+a}},{key:"convertTimeToIndex",value:function(t){var e,a,r=t.split(":"),o=0,n=!1,s=0;switch(t.length>5&&(n=!0),e=Number(r[0]),a=Number(r[1]),1==n&&(o=Number(r[2])),this.maxIntervalCount){case i.ONE_SECOND:s=3600*e,s+=60*a,!0===n&&(s+=o);break;case i.ONE_MINUTE:s=60*e,s+=a;break;case i.FIVE_MINUTES:s=12*e,s+=a/5;break;case i.TEN_MINUTES:s=6*e,s+=a/10;break;case i.FIFTEEN_MINUTES:s=4*e,s+=a/15;break;case i.TWENTY_MINUTES:s=3*e,s+=a/20;break;case i.THIRTY_MINUTES:s=2*e,s+=a/30;break;case i.ONE_HOUR:s=e;break;default:s=0}return s}},{key:"setChartData",value:function(t){var e=new Array(this.maxIntervalCount).fill(0),a=this.displayIntervalCount;if(this.displayIntervalCount>this.maxIntervalCount&&(a=this.maxIntervalCount),null!=t&&Array.isArray(t)&&t.length>0){this.totalSteps=0,this.setMaxIntervalCount(this.maxIntervalCount);var r,i=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return u(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;e[this.convertTimeToIndex(o.startTime)]+=o.stepCount,this.totalSteps+=o.stepCount}}catch(t){i.e(t)}finally{i.f()}for(var n=new Array(a).fill(0),s=this.maxIntervalCount/a,l=0,h=0,c=0;c<a;c++)for(l=0;l<s;l++)n[c]+=e[h],h++;this.intervalUsed=this.displayIntervalCount,this.defdata.labels=new Array(a).fill(""),this.defdata.datasets[0].data=n,this.chart.update()}}},{key:"resetChart",value:function(){this.defdata.datasets[0].data=[],this.totalSteps=0,this.chart.options.plugins.customCursorTracker.enabled=!1,this.chart.options.plugins.customToolTip.enabled=!1,this.chart.update()}},{key:"setMaxStepsPerInterval",value:function(t){this.chart.options.scales.y.max=t,this.chart.update()}},{key:"setMaxIntervalCount",value:function(t){this.maxIntervalCount=t}},{key:"setDisplayIntervalCount",value:function(t){this.displayIntervalCount=t}},{key:"convertTimeToTimeFormat",value:function(t){if(this.timeFormat===r.USE_12HR_FORMAT){var e=t.split(":"),a=parseInt(e[0],10),i=parseInt(e[1],10),o=a>=12?"PM":"AM";return((a=a%12==0?12:a%12)<10?"0":"")+a+":"+(i<10?"0":"")+i+" "+o}return t}},{key:"setTimeDisplayFormat",value:function(t){this.timeFormat=t,this.chart.options.plugins.customXAxisBackground.label1=this.convertTimeToTimeFormat("00:00"),this.chart.options.plugins.customXAxisBackground.label2=this.convertTimeToTimeFormat("12:00"),this.chart.options.plugins.customXAxisBackground.label3=this.convertTimeToTimeFormat("23:59"),this.chart.update()}},{key:"setBarColor",value:function(t){this.barColor=t,this.defdata.datasets[0].backgroundColor=t,this.defdata.datasets[0].borderColor=t,this.defdata.datasets[0].hoverBackgroundColor=t,this.chart.update()}},{key:"getLocalizedStepCountString",value:function(t){return"es"===t?"PASOS":"STEP COUNT"}},{key:"getLocalizedTotalStepsString",value:function(t){return"es"===t?"PASOS TOTALES":"TOTAL STEPS"}},{key:"setLanguage",value:function(t){this.language=t,this.chart.update()}}])&&d(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),p={AWAKE:0,LIGHT_SLEEP:1,DEEP_SLEEP:2,REM_SLEEP:3};function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function g(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,b(r.key),r)}}function b(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:String(e)}const C=function(){function t(e,a,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quality=e,this.startTime=a,this.endTime=r}var e,a;return e=t,(a=[{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}},{key:"endTime",get:function(){return this._endTime},set:function(t){this._endTime=t}},{key:"totalTime",get:function(){var t=new Date(this._startTime.replace(" ","T")+":00");return(new Date(this._endTime.replace(" ","T")+":00")-t)/6e4}}])&&g(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function T(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,D(r.key),r)}}function D(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==x(e)?e:String(e)}const A=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quality=e.quality,this.startTime=e.startTime,this.endTime=e.endTime,this.startIndex=0,this.endIndex=0}var e,a;return e=t,(a=[{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}},{key:"endTime",get:function(){return this._endTime},set:function(t){this._endTime=t}},{key:"startIndex",get:function(){return this._startIndex},set:function(t){this._startIndex=t}},{key:"endIndex",get:function(){return this._endIndex},set:function(t){this._endIndex=t}},{key:"setIndices",value:function(t,e){this.startIndex=t,this.endIndex=e}}])&&T(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function E(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=I(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}function I(t,e){if(t){if("string"==typeof t)return k(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function L(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function M(t,e,a){return(e=w(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function w(t){var e=function(t,e){if("object"!=S(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:String(e)}const H=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),M(this,"customClickTrackerHandler",(function(t,e,r){if(!0===r.enabled&&"click"===e.event.type){var i=a.chart.options.plugins.customToolTip;i.enabled=!i.enabled,a.chart.update()}})),M(this,"customCursorTrackerHandler",(function(t,e,r){if(!0===r.enabled){t.ctx,t.canvas;for(var i=t.scales.x,o=(t.scales.y,t.chartArea),n=(o.top,o.right,o.bottom,o.left,i.getValueForPixel(e.event.x)),s=0;s<a.blockList.length&&!(n>=a.blockList[s].startIndex&&n<=a.blockList[s].endIndex);s++);s>=0&&s<a.blockList.length&&(a.blockIndex=s,a.toolTipXCoor=e.event.x)}})),M(this,"customToolTipHandler",(function(t,e,r){if(!0===r.enabled){var i=t.ctx,o=(t.canvas,t.scales.x),n=(t.scales.y,t.chartArea),s=(n.top,n.right,n.bottom),l=(n.left,o.getPixelForValue(t.config._config.options.plugins.customToolTip.xCoor),120),h=a.blockList[a.blockIndex],c=h.startTime.split(" ")[1],u=h.endTime.split(" ")[1],d=a.getXAxisLabelsWithFormatting(c).toLowerCase()+" - "+a.getXAxisLabelsWithFormatting(u).toLowerCase(),f="";switch(h.quality){case p.LIGHT_SLEEP:f=a.getLocalizedLightSleepString(a.language);break;case p.DEEP_SLEEP:f=a.getLocalizedDeepSleepString(a.language);break;case p.REM_SLEEP:f=a.getLocalizedREMSleepString(a.language);break;default:f=a.getLocalizedAwakeString(a.language)}i.save(),i.fillStyle=r.backgroundColor,i.fillRect(a.toolTipXCoor-60,s-80,l,50),i.strokeStyle="#B4B4B4",i.lineWidth=2,i.strokeRect(a.toolTipXCoor-60,s-80,l,50),i.beginPath(),i.moveTo(a.toolTipXCoor-7,s-31),i.lineTo(a.toolTipXCoor+7,s-31),i.lineTo(a.toolTipXCoor,s-20),i.closePath(),i.stroke(),i.fill(),i.strokeStyle="white",i.lineWidth=3,i.moveTo(a.toolTipXCoor-7,s-31),i.lineTo(a.toolTipXCoor+7,s-31),i.stroke(),i.font="24px",i.fillStyle="black",i.textAlign="left",i.fillText(f,a.toolTipXCoor-60+4,s-60),i.fillText(d,a.toolTipXCoor-60+4,s-40),i.restore()}})),this.ctx=e,this.barColor="#FFFFFFFF",this.timeFormat=r.USE_12HR_FORMAT,this.maxIntervalCount=i.ONE_MINUTE,this.sleepStartTime="22:00",this.sleepEndTime="06:00",this.language=h.ENGLISH,this.sleepColors=["#FFFFFF","#C3BEE3","#8551D3","#3F098A"],this.blockIndex=0,this.toolTipXCoor=0,this.blockList=[],this.defdata={labels:[""],datasets:[{type:"bar",data:[],backgroundColor:this.barColor,borderColor:this.barColor,borderWidth:0,barPercentage:1,categoryPercentage:1},{type:"line",spanGaps:!0,data:[],tension:.6,pointRadius:0}]};var o={data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{maxTicksLimit:24,callback:function(t,e,a){return a.length,""}}},y:{display:!1,beginAtZero:!0,max:255}},plugins:{tooltip:{enabled:!1},legend:{display:!1},customXAxisLabels:{enabled:!0,label1:this.getXAxisLabelsWithFormatting(this.sleepStartTime),label2:this.getXAxisLabelsWithFormatting(this.sleepEndTime)},customNoDataBackground:{enabled:!0,backgroundColor:"rgba(200, 200, 200, 0.5)",label:this.getLocalizedNoDataString(this.language),emptyChart:!0},customHRMinMaxMarker:{enabled:!1,minHRValue:0,minHRIndex:0,maxHRValue:0,maxHRIndex:0},customClickTracker:{enabled:!1},customCursorTracker:{enabled:!1},customToolTip:{enabled:!1,backgroundColor:"white"}}}};if("function"!=typeof Chart){var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/chart.js",document.head.appendChild(n)}this.addCustomPlugins(),this.chart=new Chart(this.ctx,o),console.log(this.chart.width),console.log(this.chart.chartArea.right)}var e,a;return e=t,a=[{key:"addCustomPlugins",value:function(){Chart.register({id:"customXAxisLabels",beforeDraw:this.customXAxisLabelsHandler}),Chart.register({id:"customNoDataBackground",beforeDraw:this.customNoDataBackgroundHandler}),Chart.register({id:"customHRMinMaxMarker",afterDatasetsDraw:this.customHRMinMaxMarkerHandler}),Chart.register({id:"customClickTracker",afterEvent:this.customClickTrackerHandler}),Chart.register({id:"customCursorTracker",afterEvent:this.customCursorTrackerHandler}),Chart.register({id:"customToolTip",afterDatasetsDraw:this.customToolTipHandler})}},{key:"customXAxisLabelsHandler",value:function(t,e,a){var r=t.ctx;t.scales.x,r.save(),r.fillStyle="rgba(237, 239, 240, 1.0)",r.fillRect(0,t.chartArea.bottom,t.width,30),r.fillStyle="black",r.textAlign="center",r.fillText(a.label1,t.chartArea.left+30,t.chartArea.bottom+15),r.fillText(a.label2,t.chartArea.right-30,t.chartArea.bottom+15),r.restore()}},{key:"customNoDataBackgroundHandler",value:function(t,e,a){if(!0===a.emptyChart){var r=t.ctx,i=(t.canvas,t.scales.x),o=t.chartArea;o.top,o.right,o.bottom,o.left,r.save(),r.fillStyle=a.backgroundColor,r.fillRect(0,0,t.width,t.chartArea.bottom),r.fillStyle="black",r.font="20px Arial",r.textAlign="center",r.textBaseline="middle",r.fillText(a.label,i.width/2,t.chartArea.bottom/2),r.restore()}}},{key:"customHRMinMaxMarkerHandler",value:function(t,e,a){if(!0===a.enabled){var r=t.ctx,i=(t.canvas,t.scales.x),o=t.scales.y,n=t.chartArea,s=(n.top,n.right,n.bottom,n.left,i.getPixelForValue(a.minHRIndex)),l=o.getPixelForValue(a.minHRValue),h=i.getPixelForValue(a.maxHRIndex),c=o.getPixelForValue(a.maxHRValue);r.save(),r.beginPath(),r.arc(s,l,4,0,2*Math.PI),r.arc(h,c,4,0,2*Math.PI),r.fillStyle="white",r.lineWidth=2,r.fill(),r.closePath(),r.font="24px",r.textAlign="center",r.textBaseline="middle",r.fillText(String(a.minHRValue),s,l+15),r.fillText(String(a.maxHRValue),h,c-15),r.restore()}}},{key:"convertTimeToIndex",value:function(t){var e,a,r=(e=t.split(":"),a=3,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var r,i,o,n,s=[],l=!0,h=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(r=o.call(a)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=a.return&&(n=a.return(),Object(n)!==n))return}finally{if(h)throw i}}return s}}(e,a)||I(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],o=r[1];return r[2],60*Number(i)+Number(o)}},{key:"updateChart",value:function(t,e,a){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=0,n=[],s=[],l=E(a);try{for(l.s();!(r=l.n()).done;){var h=r.value;o<this.maxIntervalCount&&(n.push(255),s.push(this.sleepColors[h]),o++)}}catch(t){l.e(t)}finally{l.f()}var c=new Array(1440).fill(0);if(null!==i){var u,d=E(i);try{for(d.s();!(u=d.n()).done;){var f=u.value;c[this.convertTimeToIndex(f.timeStamp)]=f.heartRate}}catch(t){d.e(t)}finally{d.f()}}for(var y=this.convertTimeToIndex(t.split(" ")[1]),m=0,p=0,v=0,g=255,b=[],C=0;C<n.length;C++){var x=c[y];x>0?b.push(x):b.push(null),x>0&&(x>p&&(p=x,m=C),x<g&&(g=x,v=C)),++y>=1440&&(y=0)}this.defdata.labels=new Array(n.length).fill(""),this.defdata.datasets[0].data=n,this.defdata.datasets[0].backgroundColor=s,this.defdata.datasets[0].borderColor=s,this.defdata.datasets[0].hoverBackgroundColor=s,this.defdata.datasets[0].order=2,this.defdata.datasets[1].data=b,this.defdata.datasets[1].backgroundColor="white",this.defdata.datasets[1].borderColor="white",this.defdata.datasets[1].order=1,this.sleepStartTime=t.split(" ")[1],this.sleepEndTime=e.split(" ")[1];var T=this.chart.options.plugins;if(T.customXAxisLabels.label1=this.getXAxisLabelsWithFormatting(this.sleepStartTime),T.customXAxisLabels.label2=this.getXAxisLabelsWithFormatting(this.sleepEndTime),g<255&&p>0){T.customHRMinMaxMarker.enabled=!0,T.customHRMinMaxMarker.minHRIndex=v,T.customHRMinMaxMarker.minHRValue=g,T.customHRMinMaxMarker.maxHRIndex=m,T.customHRMinMaxMarker.maxHRValue=p;var D=this.chart.config.options.scales.y;D.min=g,D.max=p,g-5>=0&&(D.min=g-5),p+5<=255&&(D.max=p+5)}T.customNoDataBackground.emptyChart=!1,T.customClickTracker.enabled=!0,T.customCursorTracker.enabled=!0,this.chart.update()}},{key:"setChartData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!=t&&Array.isArray(t)&&t.length>0){var a=[];t.sort((function(t,e){var a=t.startTime,r=e.startTime;return a<r?-1:a>r?1:0}));for(var r=0;r<t.length;r++)if(r<t.length-1){var i=t[r].endTime,o=t[r+1].startTime;i!==o&&t.splice(r+1,0,new C(p.AWAKE,i,o))}var n=0,s=0;this.blockList=[];var l,h=E(t);try{for(h.s();!(l=h.n()).done;){var c=l.value,u=new A(c);n=s;for(var d=0;d<c.totalTime;d++)a.push(c.quality),s++;u.setIndices(n,s-1),this.blockList.push(u)}}catch(t){h.e(t)}finally{h.f()}null!==e?this.updateChart(t[0].startTime,t[t.length-1].endTime,a,e):this.updateChart(t[0].startTime,t[t.length-1].endTime,a)}}},{key:"resetChart",value:function(){var t=this.chart.options.plugins;this.defdata.datasets[0].data=[],this.defdata.datasets[1].data=[],this.sleepStartTime="22:00",this.sleepEndTime="06:00",t.customXAxisLabels.label1=this.getXAxisLabelsWithFormatting(this.sleepStartTime),t.customXAxisLabels.label2=this.getXAxisLabelsWithFormatting(this.sleepEndTime),t.customHRMinMaxMarker.enabled=!1,t.customClickTracker.enabled=!1,t.customCursorTracker.enabled=!1,t.customToolTip.enabled=!1,t.customNoDataBackground.emptyChart=!0,this.chart.update()}},{key:"getXAxisLabelsWithFormatting",value:function(t){if(this.timeFormat===r.USE_12HR_FORMAT){var e=t.split(":"),a=parseInt(e[0],10),i=parseInt(e[1],10),o=a>=12?"PM":"AM";return((a=a%12==0?12:a%12)<10?"0":"")+a+":"+(i<10?"0":"")+i+" "+o}return t}},{key:"setTimeDisplayFormat",value:function(t){this.timeFormat=t,this.chart.options.plugins.customXAxisLabels.label1=this.getXAxisLabelsWithFormatting(this.sleepStartTime),this.chart.options.plugins.customXAxisLabels.label2=this.getXAxisLabelsWithFormatting(this.sleepEndTime),this.chart.update(),console.log(this.chart.width),console.log(this.chart.chartArea.right)}},{key:"getLocalizedNoDataString",value:function(t){return"es"===t?"Sin Datos":"No Data"}},{key:"getLocalizedAwakeString",value:function(t){return"es"===t?"Despierto":"Awake"}},{key:"getLocalizedLightSleepString",value:function(t){return"es"===t?"Sueño ligero":"Light Sleep"}},{key:"getLocalizedDeepSleepString",value:function(t){return"es"===t?"Sueño profundo":"Deep Sleep"}},{key:"getLocalizedREMSleepString",value:function(t){return"es"===t?"Sueño REM":"REM Sleep"}},{key:"setLanguage",value:function(t){this.language=t,this.chart.options.plugins.customNoDataBackground.label=this.getLocalizedNoDataString(t),this.chart.update()}}],a&&L(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();var P={BELOW_AVERAGE:0,FAIR:1,GOOD:2,VERY_GOOD:3,EXCELLENT:4};function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function N(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function O(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:String(e)}const _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.ageValue=0,this.thresholdValue=[66,62,58,54];var a=["#EB5B59","#F7BD4C","#01B9FE","#9071FE","#26CBA8"];this.defdata={labels:["","","","",""],datasets:[{data:[12,12,12,12,12],backgroundColor:a,borderColor:a,hoverBackgroundColor:a,borderWidth:0,barPercentage:1,categoryPercentage:1}]};var r={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{display:!1,maxTicksLimit:24}},y:{display:!1,beginAtZero:!0,max:35}},plugins:{tooltip:{enabled:!1},legend:{display:!1},selectedBarImage:{enabled:!1,barIndex:2,heartHeightRatio:1,heartWidthRatio:.6,heartColor:"white"}}}};if("function"!=typeof Chart){var i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/chart.js",document.head.appendChild(i)}this.addCustomChartPlugins(),this.chart=new Chart(this.ctx,r)}var e,a;return e=t,(a=[{key:"addCustomChartPlugins",value:function(){Chart.register({id:"selectedBarImage",afterDraw:function(t,e,a){var r=t.ctx,i=t.chartArea,o=t.options.plugins.selectedBarImage;if(o&&!0===o.enabled){var n=o.barIndex||0;if(n>=0&&n<t.data.labels.length){var s=t.getDatasetMeta(0).data[n].x,l=t.getDatasetMeta(0).data[n].width,h=i.height/1.3,c=l*o.heartWidthRatio,u=h*o.heartHeightRatio,d=o.heartColor||"red",f=s,y=i.top+h;r.fillStyle=d,r.beginPath(),r.moveTo(f,y-u/2),r.bezierCurveTo(f-c/3,y-u,f-c,y-u/3,f,y),r.bezierCurveTo(f+c,y-u/3,f+c/3,y-u,f,y-u/2),r.closePath(),r.fill()}}}})}},{key:"setAgeLevelThresholds",value:function(t,e,a,r){this.thresholdValue[0]=t,this.thresholdValue[1]=e,this.thresholdValue[2]=a,this.thresholdValue[3]=r,this.setChartData(this.ageValue)}},{key:"setChartData",value:function(t){var e,a=12,r=12,i=12,o=12,n=12;this.ageValue=t,0==t?e=P.NONE:t>this.thresholdValue[0]?(a=35,e=P.BELOW_AVERAGE):t>this.thresholdValue[1]?(r=35,e=P.FAIR):t>this.thresholdValue[2]?(i=35,e=P.GOOD):t>this.thresholdValue[3]?(o=35,e=P.VERY_GOOD):(n=35,e=P.EXCELLENT),this.chart.options.plugins.selectedBarImage.enabled=!0,this.chart.options.plugins.selectedBarImage.barIndex=e,this.defdata.datasets[0].data=[a,r,i,o,n],this.chart.update()}},{key:"resetChart",value:function(){this.chart.options.plugins.selectedBarImage.enabled=!1,this.defdata.datasets[0].data=[12,12,12,12,12],this.chart.update()}}])&&N(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(e)?e:String(e)}const U=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paiScore=e,this.paiEarned=a}var e,a;return e=t,(a=[{key:"paiScore",get:function(){return this._paiScore},set:function(t){this._paiScore=t}},{key:"paiEarned",get:function(){return this._paiEarned},set:function(t){this._paiEarned=t}},{key:"paiCarriedOver",get:function(){return this._paiScore-this._paiEarned}}])&&F(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),W={PAI_SCORE:0,PAI_HISTORY:1};var j="#8551D3",V="#C0B2FB",Y="#D3D3D3",G="#E9E7F3";function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function z(t,e){if(t){if("string"==typeof t)return K(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?K(t,e):void 0}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function $(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q(r.key),r)}}function q(t,e,a){return(e=Q(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Q(t){var e=function(t,e){if("object"!=J(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==J(e)?e:String(e)}const Z=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),q(this,"processBarClick",(function(t,e){var r=e[0];if(r){a.chart.data;var i=a.chart.options.plugins,o=i.customToolTip;(!1===o.enabled||!0===o.enabled&&o.barIndex===r.index)&&(i.customChartFadeEffect.enabled=!i.customChartFadeEffect.enabled,o.enabled=!o.enabled),i.customChartFadeEffect.barIndex=r.index,o.barIndex=r.index,a.chart.update()}})),q(this,"getTopXAxisLabel",(function(t,e,r){return a.topXAxisLabels[t]})),q(this,"getBottomXAxisLabel",(function(t,e,r){return a.bottomXAxisLabels[t]})),q(this,"customTodayHighlightHandler",(function(t,e,r){if(r.enabled){var i=t.ctx,o=t.scales.x1;if(i.save(),a.filter===W.PAI_SCORE){var n=o.getPixelForValue(a.defdata.datasets[2].data.length-1),s=t.chartArea.width/7;console.log(t),i.fillStyle="rgba(211, 211, 211, 0.3)",i.fillRect(n-s/4,0,s/2,t.height)}i.restore()}})),q(this,"customChartFadeEffectHandler",(function(t,e,r){if(r.enabled){var i=t.ctx,o=t.scales.x1;if(i.save(),a.filter===W.PAI_HISTORY){var n=o.getPixelForValue(r.barIndex),s=t.chartArea.width/7;i.fillStyle="rgba(211, 211, 211, 0.3)",i.fillRect(n-s/4,0,s/2,t.chartArea.bottom)}else i.fillStyle="rgba(255, 255, 255, 0.6)",i.fillRect(0,0,t.width,t.height);i.restore()}})),q(this,"customToolTipHandler",(function(t,e,r){r.enabled&&(a.filter===W.PAI_HISTORY?a.displayPAIHistoryToolTip(t,r):a.displayPAIScoreToolTip(t,r))})),this.ctx=e,this.barColor="#3EB1C8",this.goalValue=100,this.maxLevel=100,this.language=h.ENGLISH,this.filter=W.PAI_SCORE,this.topXAxisLabels=["0","0","0","0","0","0","0"],this.bottomXAxisLabels=["S","M","T","W","T","F","TODAY"],this.dateList=[];var r=new Date;r.getFullYear(),r.getMonth(),r.getDate(),this.customDate=new Date,this.updateBottomXAxisLabels(r),this.defdata={labels:this.bottomXAxisLabels,datasets:[{backgroundColor:V,hoverBackgroundColor:V,data:[0,0,0,0,0,0,0],barThickness:20},{backgroundColor:j,hoverBackgroundColor:j,data:[0,0,0,0,0,0,0],barThickness:20},{backgroundColor:[G,G,G,G,G,G,Y],hoverBackgroundColor:[G,G,G,G,G,G,Y],data:[100,100,100,100,100,100,100],barThickness:20}]};var i={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{stacked:!0,grid:{display:!1},position:"bottom",ticks:{stepSize:10,padding:0,callback:this.getBottomXAxisLabel,font:{size:[,,,,,,12],weight:["normal","normal","normal","normal","normal","normal","bold"]}}},x1:{display:!1,grid:{display:!1},position:"top",ticks:{callback:this.getTopXAxisLabel}},y:q(q(q({stacked:!0,max:100,display:!0,beginAtZero:!0},"max",this.maxLevel),"grid",{drawBorder:!1,lineWidth:1,color:"#D9D2F8",tick:{stepSize:50}}),"ticks",{autoSkip:!0,maxTicksLimit:4})},plugins:{tooltip:{enabled:!1},legend:{display:!1},customGoalLevelLimitLine:{enabled:!0,goalValue:this.goalValue,lineColor:"#26CBA8",lineWidth:2},customTotalText:{enabled:!1},customTodayHighlight:{enabled:!1},customChartFadeEffect:{enabled:!1,barIndex:0},customToolTip:{enabled:!1,barIndex:0,backgroundColor:"white"}},onClick:this.processBarClick}};this.addCustomPlugins(),this.chart=new Chart(this.ctx,i)}var e,a;return e=t,(a=[{key:"getLocalizedTodayString",value:function(t){return"es"===t?"HOY":"TODAY"}},{key:"getLocalizedPAIScoreString",value:function(t){return"es"===t?"Puntaje PAI":"PAI Score"}},{key:"getLocalizedPAIEarnedString",value:function(t){return"es"===t?"PAI obtenido":"PAI Earned"}},{key:"getLocalizedPAICarriedOverString",value:function(t){return"es"===t?"PAI acumulado":"PAI Carried Over"}},{key:"getLocalized1LetterDOWString",value:function(t,e){return"es"===t?["d","l","m","m","j","v","s"][e]:["S","M","T","W","T","F","S"][e]}},{key:"updateBottomXAxisLabels",value:function(t){var e=t.getDay();this.bottomXAxisLabels[this.bottomXAxisLabels.length-1]=this.getLocalizedTodayString(this.language),this.dateList.push(t);for(var a=this.bottomXAxisLabels.length-2;a>=0;a--)t.setDate(t.getDate()-1),e=t.getDay(),this.bottomXAxisLabels[a]=this.getLocalized1LetterDOWString(this.language,e),this.dateList.push(t.toString());this.dateList.reverse()}},{key:"addCustomPlugins",value:function(){Chart.register({id:"customGoalLevelLimitLine",afterDatasetsDraw:this.customGoalLevelLimitLineHandler}),Chart.register({id:"customTotalText",afterDatasetsDraw:this.customTotalTextHandler}),Chart.register({id:"customTodayHighlight",afterDatasetsDraw:this.customTodayHighlightHandler}),Chart.register({id:"customChartFadeEffect",afterDatasetsDraw:this.customChartFadeEffectHandler}),Chart.register({id:"customToolTip",afterDatasetsDraw:this.customToolTipHandler})}},{key:"customGoalLevelLimitLineHandler",value:function(t,e,a){var r=t.ctx,i=t.scales.y,o=t.chartArea.left,n=i.getPixelForValue(t.options.plugins.customGoalLevelLimitLine.goalValue);r.save(),r.beginPath(),r.moveTo(o,n),r.strokeStyle=t.options.plugins.customGoalLevelLimitLine.lineColor,r.lineWidth=t.options.plugins.customGoalLevelLimitLine.lineWidth,r.lineTo(t.chartArea.right,n),r.stroke(),r.restore()}},{key:"customTotalTextHandler",value:function(t,e,a){if(a.enabled){var r=t.ctx;r.save();var i=t.chartArea,o=(t.scales.x1,t.scales.x._labelItems[0].font.lineHeight),n=i.top-o;r.fillStyle="black",r.textAlign="left",r.fillText("Total",0,n),r.restore()}}},{key:"displayPAIScoreToolTip",value:function(t,e){var a=t.ctx,r=t.scales.x,i=t.scales.y,o=t.chartArea,n=o.top,s=(o.right,o.bottom,o.left,r.getPixelForValue(e.barIndex)),l=(i.getPixelForValue(n),140),h=this.defdata.datasets[0].data[e.barIndex],c=this.defdata.datasets[1].data[e.barIndex],u=new Date(this.dateList[e.barIndex]),d=u.getFullYear(),f=u.toLocaleDateString("".concat(this.language,"-US"),{month:"short"}),y=u.getDate(),m=u.toLocaleDateString("".concat(this.language,"-US"),{weekday:"short"});a.save(),a.fillStyle=e.backgroundColor,a.fillRect(s-70,n+10,l,50),a.strokeStyle="black",a.lineWidth=1,a.strokeRect(s-70,n+10,l,50),a.lineWidth=2,a.beginPath(),a.fillStyle=V,a.arc(s-70+10,n+35,4,0,2*Math.PI),a.fill(),a.closePath(),a.beginPath(),a.fillStyle=j,a.arc(s-70+10,n+50,4,0,2*Math.PI),a.fill(),a.closePath(),a.font="24px",a.fillStyle="black",a.textAlign="left",a.fillText("".concat(m,", ").concat(f," ").concat(y,", ").concat(d),s-70+7,n+25),a.fillText("".concat(this.getLocalizedPAICarriedOverString(this.language)," ").concat(h),s-70+20,n+40),a.fillText("".concat(this.getLocalizedPAIEarnedString(this.language)," ").concat(c),s-70+20,n+55),a.restore()}},{key:"displayPAIHistoryToolTip",value:function(t,e){var a=t.ctx,r=t.scales.x,i=(t.scales.y,t.chartArea),o=i.top,n=(i.right,i.bottom,i.left,this.defdata.datasets[0].data[e.barIndex]),s=this.defdata.datasets[1].data[e.barIndex],l=s+n,h=new Date(this.dateList[e.barIndex]),c=h.getFullYear(),u=h.toLocaleDateString("".concat(this.language,"-US"),{month:"short"}),d=h.getDate(),f=h.toLocaleDateString("".concat(this.language,"-US"),{weekday:"short"}),y=0,m=10,p=75;a.save();var v=0,g=o+5,b=0;if(a.beginPath(),0===e.barIndex)v=r.getPixelForValue(e.barIndex)-80,y=155,a.moveTo(v+y-m,g+p),a.lineTo(v+y/2+7.5,g+p),a.lineTo(v+y/2,g+p+15),a.lineTo(v+y/2-7.5,g+p),a.lineTo(v+m,g+p),a.arcTo(v,g+p,v,g,m),a.arcTo(v,g,v+y,g,m),a.arcTo(v+y,g,v+y,g+p,m),a.arcTo(v+y,g+p,v+y-m,g+p,m),b=v+80;else{var C=(v=r.getPixelForValue(e.barIndex)-113)+(y=85)/1.2;a.moveTo(C+m,g+p),a.lineTo(C+y/2-7.5,g+p),a.lineTo(C+y/2,g+p+15),a.lineTo(C+y/2+7.5,g+p),a.lineTo(C+y-m,g+p),a.arcTo(C+y,g+p,C+y,g,m),a.arcTo(C+y,g,v,g,m),a.arcTo(v,g,v,g+p,m),a.arcTo(v,g+p,C+m,g+p,m),b=v+45}a.closePath(),a.fillStyle="white",a.fill(),a.strokeStyle="#DED7F9",a.stroke(),m=4,a.beginPath(),a.fillStyle=j,a.arc(b-y/2+10,o+48,m,0,2*Math.PI),a.fill(),a.closePath(),a.beginPath(),a.fillStyle=V,a.arc(b-y/2+10,o+63,m,0,2*Math.PI),a.fill(),a.closePath(),a.font="24pt",a.fillStyle="black",a.textAlign="left",a.fillText("".concat(f,", ").concat(u," ").concat(d,", ").concat(c),b-y/2+7,o+23),a.fillText("".concat(this.getLocalizedPAIScoreString(this.language),": "),b-y/2+7,o+38),a.fillText("".concat(this.getLocalizedPAIEarnedString(this.language),": ").concat(s," PAI"),b-y/2+20,o+53),a.fillText("".concat(this.getLocalizedPAICarriedOverString(this.language),": ").concat(n," PAI"),b-y/2+20,o+68),a.font="bold 11pt Arial",a.fillStyle="#26CBA8",a.fillText("".concat(l," PAI"),b-y/2+75,o+39),a.restore()}},{key:"updateChart",value:function(t,e){for(var a=[],r=0;r<t.length;r++)this.goalValue<=t[r]+e[r]?a.push(0):a.push(this.goalValue-(t[r]+e[r]));this.defdata.datasets[0].data=e,this.defdata.datasets[1].data=t,this.defdata.datasets[2].data=a,this.chart.data.datasets[2].backgroundColor[6]=G,this.chart.data.datasets[2].hoverBackgroundColor[6]=G,this.chart.options.scales.x1.display=!0,this.chart.options.plugins.customTotalText.enabled=!0,this.chart.options.plugins.customTodayHighlight.enabled=!0,this.chart.update()}},{key:"setMaxLevel",value:function(t){for(this.maxLevel=100,this.chart.options.scales.y.max=100,this.chart.options.scales.y.ticks.maxTicksLimit=4;this.maxLevel<t;)this.maxLevel+=50;this.chart.options.scales.y.max=this.maxLevel,this.chart.options.scales.y.ticks.maxTicksLimit=this.maxLevel/50+1}},{key:"setChartData",value:function(t){if(null!=t&&Array.isArray(t)&&t.length>0){var e=0,a=0,r=[],i=[];this.dateList=[],this.setLanguage(this.language);var o,n=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=z(t))){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}(t);try{for(n.s();!(o=n.n()).done;){var s=o.value;s.paiScore>a&&(a=s.paiScore),r.push(s.paiEarned),i.push(s.paiCarriedOver),this.topXAxisLabels[e]=s.paiScore.toString(),e++}}catch(t){n.e(t)}finally{n.f()}this.setMaxLevel(a),this.updateChart(r,i)}}},{key:"setGoalLevel",value:function(t){this.goalValue=t,this.chart.options.plugins.customGoalLevelLimitLine.goalValue=t,this.updateChart(this.defdata.datasets[1].data,this.defdata.datasets[0].data),this.chart.update()}},{key:"setChartFilter",value:function(t){this.filter=t}},{key:"resetChart",value:function(){var t=[];this.dateList=[],this.setGoalLevel(100);for(var e=0;e<7;e++)t.push(100);this.defdata.datasets[0].data=[0,0,0,0,0,0,0],this.defdata.datasets[1].data=[0,0,0,0,0,0,0],this.defdata.datasets[2].data=t,this.chart.data.datasets[2].backgroundColor[6]=Y,this.chart.data.datasets[2].hoverBackgroundColor[6]=Y,this.chart.options.scales.y.max=100,this.chart.options.scales.y.ticks.maxTicksLimit=4,this.chart.options.scales.x1.display=!1,this.chart.options.plugins.customTotalText.enabled=!1,this.chart.options.plugins.customTodayHighlight.enabled=!1,this.chart.options.plugins.customChartFadeEffect.enabled=!1,this.chart.options.plugins.customToolTip.enabled=!1,this.setLanguage(this.language),this.chart.update()}},{key:"setCustomDate",value:function(t){var e,a,r=(e=t.split("-"),a=3,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var r,i,o,n,s=[],l=!0,h=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(r=o.call(a)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=a.return&&(n=a.return(),Object(n)!==n))return}finally{if(h)throw i}}return s}}(e,a)||z(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],o=r[1],n=r[2],s=new Date(Number(i),Number(o)-1,Number(n));this.updateBottomXAxisLabels(s),s.setFullYear(Number(i)),s.setMonth(Number(o)-1),s.setDate(Number(n)),this.customDate=s,this.chart.update()}},{key:"setLanguage",value:function(t){this.language=t;var e=this.customDate.getFullYear(),a=this.customDate.getMonth()+1,r=this.customDate.getDate();this.setCustomDate(e+"-"+(a<10?"0":"")+a+"-"+(r<10?"0":"")+r),this.chart.update()}}])&&$(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),tt={DAILY:0,WEEKLY:1,MONTHLY:2};function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var r,i,o,n,s=[],l=!0,h=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(r=o.call(a)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=a.return&&(n=a.return(),Object(n)!==n))return}finally{if(h)throw i}}return s}}(t,e)||it(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=it(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}function it(t,e){if(t){if("string"==typeof t)return ot(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ot(t,e):void 0}}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function nt(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lt(r.key),r)}}function st(t,e,a){return(e=lt(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function lt(t){var e=function(t,e){if("object"!=et(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(e)?e:String(e)}const ht=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),st(this,"processBarClick",(function(t,e){var r=e[0];if(r){var i=r.index,o=a.chart.data,n=a.chart.options;o.datasets[0].backgroundColor[a.selectedBarIndex]=a.barColor,o.datasets[0].hoverBackgroundColor[a.selectedBarIndex]=a.barColor,!1===a.barSelected||a.selectedBarIndex!==i?(o.datasets[0].backgroundColor[i]=a.barSelectedColor,o.datasets[0].hoverBackgroundColor[i]=a.barSelectedColor,a.barSelected=!0,n.plugins.customIndicatorBar.enabled=!0,n.plugins.customIndicatorBar.barIndex=i,n.plugins.customIndicatorBar.barValue=o.datasets[0].data[i],a.triggerBarTapListener(i)):(a.barSelected=!1,n.plugins.customIndicatorBar.enabled=!1),a.chart.update(),a.selectedBarIndex=i}})),st(this,"handleMouseDownEvent",(function(t){a.isDragging=!0,a.startX=t.offsetX})),st(this,"handleMouseUpEvent",(function(t){a.isDragging=!1})),st(this,"handleMouseOutEvent",(function(t){a.isDragging=!1})),st(this,"handleMouseMoveEvent",(function(t){if(!0===a.isDragging){var e=t.offsetX-a.startX,r=a.chart.config.options.scales.x;e>0?e>100&&(a.startX=t.offsetX,r.min>0?(r.min-=1,r.max-=1):(r.min=0,r.max=6)):e<0&&e<-100&&(a.startX=t.offsetX,r.max<a.totalBars-1?(r.min+=1,r.max+=1):(r.min=a.totalBars-7,r.max=a.totalBars-1)),a.chart.update()}})),this.ctx=e,this.barColor="#3EB1C8",this.barSelectedColor="#909090",this.language=h.ENGLISH,this.filter=tt.DAILY,this.isDragging=!1,this.startX=0,this.selectedBarIndex=0,this.barSelected=!0,this.barsInfo=[],this.totalBars=0,this.barTapListener=null,this.defdata={labels:[this.getDefaultLocalizedString()],datasets:[{data:[0],backgroundColor:this.barColor,borderColor:this.barColor,hoverBackgroundColor:this.barColor,borderWidth:0,barThickness:40}]};var r={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{min:0,max:4,grid:{display:!1},position:"bottom"},y:{display:!1,beginAtZero:!0,max:150}},plugins:{tooltip:{enabled:!1},legend:{display:!1},customXAxisBackground:{enabled:!0},customIndicatorBar:{enabled:!0,barIndex:0,barValue:0}},onClick:this.processBarClick}};this.initBarsInfoArray(),this.addCustomPlugins(),this.chart=new Chart(this.ctx,r)}var e,a;return e=t,(a=[{key:"initBarsInfoArray",value:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),i=e+"-"+(a<10?"0":"")+a+"-"+(r<10?"0":"")+r;this.barsInfo.push(i)}},{key:"addCustomPlugins",value:function(){Chart.register({id:"customXAxisBackground",beforeDraw:function(t,e,a){var r=t.ctx,i=t.scales.x;r.save(),r.fillStyle="rgba(237, 239, 240, 1.0)",r.fillRect(0,t.chartArea.bottom,i.width,30),r.restore()}}),Chart.register({id:"customIndicatorBar",afterDatasetsDraw:function(t,e,a){if(a.enabled){var r=t.ctx,i=t.scales.y.getPixelForValue(a.barValue);r.save(),r.fillStyle="red",r.fillRect(t._metasets[0].data[a.barIndex].x-20,i-10,40,5),r.restore()}}})}},{key:"resetIndicatorBar",value:function(){this.chart.options.plugins.customIndicatorBar.enabled=!0,this.chart.options.plugins.customIndicatorBar.barIndex=0,this.chart.options.plugins.customIndicatorBar.barValue=0}},{key:"disableChartScrolling",value:function(){var t=this.chart.canvas;this.chart.config.options.scales.x.min=0,this.chart.config.options.scales.x.max=6,this.isDragging=!1,t.removeEventListener("mousedown",this.handleMouseDownEvent),t.removeEventListener("mousemove",this.handleMouseMoveEvent),t.removeEventListener("mouseup",this.handleMouseUpEvent),t.removeEventListener("mouseout",this.handleMouseOutEvent),t.removeEventListener("touchstart",this.handleMouseDownEvent),t.removeEventListener("touchmove",this.handleMouseMoveEvent),t.removeEventListener("touchend",this.handleMouseUpEvent)}},{key:"enbleChartScrolling",value:function(){var t=this.chart.canvas;this.chart.config.options.scales.x.min=this.totalBars-7,this.chart.config.options.scales.x.max=this.totalBars-1,t.addEventListener("mousedown",this.handleMouseDownEvent),t.addEventListener("mousemove",this.handleMouseMoveEvent),t.addEventListener("mouseup",this.handleMouseUpEvent),t.addEventListener("mouseout",this.handleMouseOutEvent),t.addEventListener("touchstart",this.handleMouseDownEvent),t.addEventListener("touchmove",this.handleMouseMoveEvent),t.addEventListener("touchend",this.handleMouseUpEvent)}},{key:"getMondayOfWeek",value:function(t){var e=t.getDay(),a=0===e?6:e-1;return new Date(t.setDate(t.getDate()-a))}},{key:"getDateDifference",value:function(t,e){var a=(e-t)/864e5;return Math.floor(a)}},{key:"getDateDifferenceFromToday",value:function(t){var e=(new Date-t)/864e5;return Math.floor(e)}},{key:"getWeekDifference",value:function(t,e){for(var a=this.getMondayOfWeek(e),r=0;a.getTime()<=t.getTime();)r++,a.setDate(a.getDate()+7);return r}},{key:"getWeekDifferenceFromToday",value:function(t){for(var e=this.getMondayOfWeek(t),a=new Date,r=0;e.getTime()<a.getTime();)r++,e.setDate(e.getDate()+7);return r}},{key:"getMonthDifferenceFromToday",value:function(t){var e=new Date,a=e.getFullYear(),r=e.getMonth()+1;return 12*(a-t.getFullYear())+(r-(t.getMonth()+1))}},{key:"createDailyLabels",value:function(t,e){for(var a=[],r=[],i=0;i<e;i++){var o=t.getFullYear(),n=t.getMonth()+1,s=t.getDate(),l=o+"-"+(n<10?"0":"")+n+"-"+(s<10?"0":"")+s;this.barsInfo.push(l);var h="";switch(s){case 1:case 21:case 31:h="st";break;case 2:case 22:h="nd";break;case 3:case 23:h="rd";break;default:h="th"}var c=t.toLocaleDateString("".concat(this.language,"-US"),{month:"short"})+" ".concat(s).concat(h);a.push(c),r.push(this.barColor),t.setDate(t.getDate()+1)}return[a,r]}},{key:"createWeeklyLabels",value:function(t,e){var a=this.getMondayOfWeek(t),r=new Date(a.getTime());r.setDate(r.getDate()+6);for(var i=[],o=[],n=0;n<e;n++){var s=a.getFullYear(),l=a.getMonth()+1,h=a.getDate(),c=r.getFullYear(),u=r.getMonth()+1,d=r.getDate(),f=s+"-"+(l<10?"0":"")+l+"-"+(h<10?"0":"")+h+"/"+c+"-"+(u<10?"0":"")+u+"-"+(d<10?"0":"")+d;this.barsInfo.push(f);var y=(l<10?"0":"")+l+"/"+(h<10?"0":"")+h+" - "+(u<10?"0":"")+u+"/"+(d<10?"0":"")+d;i.push(y),o.push(this.barColor),a.setDate(a.getDate()+7),r.setDate(r.getDate()+7)}return[i,o]}},{key:"createMonthlyLabels",value:function(t,e){for(var a=[],r=[],i=0;i<e;i++){var o=t.getFullYear(),n=t.getMonth()+1;t.setDate(1);var s=o+"-"+(n<10?"0":"")+n;this.barsInfo.push(s);var l=t.toLocaleDateString("".concat(this.language,"-US"),{month:"long"});a.push(l),r.push(this.barColor),t.setMonth(t.getMonth()+1)}return[a,r]}},{key:"processDailySteps",value:function(t,e,a){var r,i=new Array(a).fill(0),o=0,n=rt(t);try{for(n.s();!(r=n.n()).done;){var s=r.value,l=at(s.startTime.split("-"),3),h=l[0],c=l[1],u=l[2],d=new Date(Number(h),Number(c)-1,Number(u));i[this.getDateDifference(e,d)]=s.stepCount,s.stepCount>o&&(o=s.stepCount)}}catch(t){n.e(t)}finally{n.f()}return[i,o]}},{key:"processWeeklySteps",value:function(t,e,a){var r,i=new Array(a).fill(0),o=0,n=rt(t);try{for(n.s();!(r=n.n()).done;){var s=r.value,l=at(s.startTime.split("-"),3),h=l[0],c=l[1],u=l[2],d=new Date(Number(h),Number(c)-1,Number(u));i[this.getWeekDifference(d,e)-1]+=s.stepCount}}catch(t){n.e(t)}finally{n.f()}var f,y=rt(i);try{for(y.s();!(f=y.n()).done;){var m=f.value;m>o&&(o=m)}}catch(t){y.e(t)}finally{y.f()}return[i,o]}},{key:"processMonthlySteps",value:function(t,e,a){var r,i=new Array(a).fill(0),o=0,n=rt(t);try{for(n.s();!(r=n.n()).done;){var s=r.value,l=at(s.startTime.split("-"),3),h=l[0],c=l[1],u=l[2];new Date(Number(h),Number(c)-1,Number(u)),i[12*(h-e.getFullYear())+(c-(e.getMonth()+1))]+=s.stepCount}}catch(t){n.e(t)}finally{n.f()}var d,f=rt(i);try{for(f.s();!(d=f.n()).done;){var y=d.value;y>o&&(o=y)}}catch(t){f.e(t)}finally{f.f()}return[i,o]}},{key:"setChartData",value:function(t){if(null!=t&&Array.isArray(t)&&t.length>0){t.sort((function(t,e){var a=t.startTime,r=e.startTime;return a<r?-1:a>r?1:0}));var e=at(t[0].startTime.split("-"),3),a=e[0],r=e[1],i=e[2],o=new Date(Number(a),Number(r)-1,Number(i)),n=0,s=0,l=[],h=[],c=[];switch(this.barsInfo=[],this.filter){case tt.DAILY:n=this.getDateDifferenceFromToday(o)+1;var u=at(this.createDailyLabels(o,n),2);h=u[0],c=u[1],h[h.length-1]=this.getLocalizedTodayString(this.language),o=new Date(Number(a),Number(r)-1,Number(i));var d=at(this.processDailySteps(t,o,n),2);l=d[0],s=d[1];break;case tt.WEEKLY:n=this.getWeekDifferenceFromToday(o);var f=at(this.createWeeklyLabels(o,n),2);h=f[0],c=f[1],h[h.length-1]=this.getLocalizedThisWeekString(this.language),o=new Date(Number(a),Number(r)-1,Number(i));var y=at(this.processWeeklySteps(t,o,n),2);l=y[0],s=y[1];break;case tt.MONTHLY:n=this.getMonthDifferenceFromToday(o)+1;var m=at(this.createMonthlyLabels(o,n),2);h=m[0],c=m[1],h[h.length-1]=this.getLocalizedThisMonthString(this.language),o=new Date(Number(a),Number(r)-1,Number(i));var p=at(this.processMonthlySteps(t,o,n),2);l=p[0],s=p[1]}var v=h.length-1;this.selectedBarIndex=v,this.chart.options.plugins.customIndicatorBar.enabled=!0,this.chart.options.plugins.customIndicatorBar.barIndex=v,this.chart.options.plugins.customIndicatorBar.barValue=l[v],c[v]="#909090",this.chart.options.scales.y.max=s,this.adjustYAxisMaxValue(s),this.defdata.labels=h,this.defdata.datasets[0].data=l,this.chart.data.datasets[0].backgroundColor=c,this.chart.data.datasets[0].hoverBackgroundColor=c,this.totalBars=n,this.disableChartScrolling(),n>7&&this.enbleChartScrolling(),this.chart.update(),this.triggerBarTapListener(v)}}},{key:"adjustYAxisMaxValue",value:function(t){var e=this.chart.scales.y,a=e.getPixelForValue(1.1*t);this.chart.options.scales.y.max=e.getValueForPixel(a)}},{key:"setChartFilter",value:function(t){this.filter=t,0===this.barsInfo.length&&this.resetChart()}},{key:"getDefaultLocalizedString",value:function(){switch(this.filter){case tt.DAILY:return this.getLocalizedTodayString(this.language);case tt.WEEKLY:return this.getLocalizedThisWeekString(this.language);case tt.MONTHLY:return this.getLocalizedThisMonthString(this.language)}return""}},{key:"shiftBarSelection",value:function(t){var e=this.chart.data,a=this.chart.options;e.datasets[0].backgroundColor[this.selectedBarIndex]=this.barColor,e.datasets[0].hoverBackgroundColor[this.selectedBarIndex]=this.barColor,e.datasets[0].backgroundColor[t]=this.barSelectedColor,e.datasets[0].hoverBackgroundColor[t]=this.barSelectedColor,this.barSelected=!0,a.plugins.customIndicatorBar.enabled=!0,a.plugins.customIndicatorBar.barIndex=t,a.plugins.customIndicatorBar.barValue=e.datasets[0].data[t],t<this.chart.config.options.scales.x.min?(this.chart.config.options.scales.x.max-=this.chart.config.options.scales.x.min-t,this.chart.config.options.scales.x.min=t):t>this.chart.config.options.scales.x.max&&(this.chart.config.options.scales.x.min+=t-this.chart.config.options.scales.x.max,this.chart.config.options.scales.x.max=t),this.chart.update(),this.triggerBarTapListener(t),this.selectedBarIndex=t}},{key:"shiftBarSelectionLeft",value:function(){this.selectedBarIndex>0&&this.shiftBarSelection(this.selectedBarIndex-1)}},{key:"shiftBarSelectionRight",value:function(){this.selectedBarIndex<this.chart.data.datasets[0].data.length-1&&this.shiftBarSelection(this.selectedBarIndex+1)}},{key:"resetChart",value:function(){this.selectedBarIndex=0,this.barSelected=!0,this.barsInfo=[],this.defdata.datasets[0].data=[0],this.defdata.labels=[this.getDefaultLocalizedString()],this.chart.data.datasets[0].data=[0],this.chart.data.labels=[this.getDefaultLocalizedString()],this.chart.options.plugins.customIndicatorBar.enabled=!1,this.disableChartScrolling(),this.resetIndicatorBar(),this.chart.update()}},{key:"triggerBarTapListener",value:function(t){null!==this.barTapListener&&void 0!==this.barTapListener&&this.barTapListener(this.barsInfo[t])}},{key:"setBarTapListener",value:function(t){this.barTapListener=t,this.barSelected&&this.triggerBarTapListener(this.selectedBarIndex)}},{key:"getLocalizedTodayString",value:function(t){return"es"===t?"Hoy":"Today"}},{key:"getLocalizedThisWeekString",value:function(t){return"es"===t?"Esta Semana":"This Week"}},{key:"getLocalizedThisMonthString",value:function(t){return"es"===t?"Este Mes":"This Month"}},{key:"setLanguage",value:function(t){this.language=t,this.defdata.labels[this.defdata.labels.length-1]=this.getLocalizedTodayString(this.language),this.chart.update()}}])&&nt(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ut(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dt(r.key),r)}}function dt(t){var e=function(t,e){if("object"!=ct(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ct(e)?e:String(e)}const ft=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._hr=e,this._time=a}var e,a;return e=t,(a=[{key:"hr",get:function(){return this._hr},set:function(t){this._hr=t}},{key:"time",get:function(){return this._time},set:function(t){this._time=t}}])&&ut(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function mt(t){return function(t){if(Array.isArray(t))return vt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||pt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,e){if(t){if("string"==typeof t)return vt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?vt(t,e):void 0}}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function gt(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ct(r.key),r)}}function bt(t,e,a){return(e=Ct(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Ct(t){var e=function(t,e){if("object"!=yt(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yt(e)?e:String(e)}const xt=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),bt(this,"hoverLineAndTextPlugin",{afterDatasetsDraw:function(t,e,r){var i=t.ctx,o=(t.canvas,t.data),n=t.chartArea,s=n.top,l=n.bottom,h=n.left,c=n.right,u=(n.width,n.height),d=t.scales,f=(d.x,d.y);if(a.xHoverCoor&&a.yHoverCoor)for(var y=0;y<t._metasets[0].data.length;y++){var m=void 0,p=void 0,v=t._metasets[0].data[y].x-1,g=t._metasets[0].data[y].x+1;if(a.xHoverCoor>=v&&a.xHoverCoor<=g){t.ctx.save(),t.ctx.beginPath();var b=void 0,C=t._metasets[0].data[y].$context.raw.y,x=t._metasets[0].data[y].$context.raw.x;if(null!==C&&a.isChartClicked){m=C,p=x,C>=a.thresholds.ADJUSTABLE_MIN&&C<a.thresholds.LOW?b=a.colors.MIN:C>=a.thresholds.LOW&&C<a.thresholds.MODERATE?b=a.colors.LOW:C>=a.thresholds.MODERATE&&C<a.thresholds.HIGH?b=a.colors.MODERATE:C>=a.thresholds.HIGH&&C<=a.thresholds.MAX&&(b=a.colors.HIGH),t.ctx.strokeStyle=b,t.ctx.lineWidth=a.lineWidthValues.HOVER_LINE,t.ctx.moveTo(a.xHoverCoor,s-20),t.ctx.lineTo(a.xHoverCoor,l),t.ctx.stroke(),t.ctx.restore();var T=u/3-m;T<s&&(T=s);var D=a.xHoverCoor-100,A=D+28;a.xHoverCoor<100+h?A=(D=h)+28:a.xHoverCoor>c-100&&(A=28+(D=c-200)),t.ctx.beginPath(),i.arc(a.xHoverCoor,f.getPixelForValue(C),5,0,2*Math.PI),i.borderWidth=5,i.borderColor="white",i.fillStyle=b,i.fill(),i.closePath(),t.ctx.beginPath(),t.ctx.fillStyle=b,t.ctx.roundRect(D-3,T-3,206,46,0),t.ctx.fill(),t.ctx.beginPath(),t.ctx.fillStyle="white",t.ctx.roundRect(D,T,200,40,0),t.ctx.fill(),t.ctx.beginPath(),i.arc(A-10,T+22,5,0,2*Math.PI),i.fillStyle=b,i.fill(),i.closePath(),t.ctx.font="bold 20px sans-serif";var S=new Date(p),E=S.getHours(),I=E>=12?"PM":"AM",k=(E%12||12).toString().padStart(2,"0"),L=S.getMinutes().toString().padStart(2,"0"),M="".concat(k,":").concat(L).concat(I),w=t.ctx.measureText("".concat(m," bpm ")).width;t.ctx.fillStyle="black",t.ctx.fillText("".concat(m," bpm "),A,T+23),t.ctx.font="20px sans-serif",t.ctx.fillText(M,A+w,T+23);break}b="rgba(255,255,255,0)"}else a.isChartClicked&&a.xHoverCoor+1>o.datasets[0].placeLineInPixels&&(t.ctx.save(),t.ctx.beginPath(),t.ctx.strokeStyle=a.colors.MIN,t.ctx.lineWidth=a.lineWidthValues.HOVER_LINE,t.ctx.moveTo(a.xHoverCoor,s-20),t.ctx.lineTo(a.xHoverCoor,l),t.ctx.stroke(),t.ctx.restore())}}}),bt(this,"customLineBorderPlugin",{beforeDraw:function(t,e){var r=t.chartArea.bottom,i=a.chartCanvas.parentNode,o=i.offsetWidth,n=window.getComputedStyle(i),s=n.getPropertyValue("padding-left"),l=n.getPropertyValue("padding-right"),h=o-(parseInt(s,10)+parseInt(l,10))-2,c=t.ctx;c.save(),c.beginPath(),c.strokeStyle="rgba(128, 128, 128,0.5)",c.moveTo(1,1),c.lineTo(h,1),c.lineTo(h,r+50),c.lineTo(1,r+50),c.closePath(),c.stroke()}}),bt(this,"nowIndicatorLinePlugin",{beforeDatasetsDraw:function(t,e,r){if(!1!==a.isLineIndicatorOn&&0!==t._metasets[0].data.length){var i=t.ctx,o=t.data,n=t.chartArea,s=(n.top,n.bottom),l=n.left,h=n.right,c=t.scales;c.x,c.y,i.save(),a.myChart.ctx.beginPath(),a.myChart.ctx.strokeStyle=a.colors.MODERATE,a.myChart.ctx.lineWidth=a.lineWidthValues.NOW_INDICATOR_LINE;var u=(f=o.datasets[0].placeLine.split(":").map(Number),y=2,function(t){if(Array.isArray(t))return t}(f)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var r,i,o,n,s=[],l=!0,h=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(r=o.call(a)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=a.return&&(n=a.return(),Object(n)!==n))return}finally{if(h)throw i}}return s}}(f,y)||pt(f,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=(60*u[0]+u[1])/1440*(h-l);o.datasets[0].placeLineInPixels=d+l,a.myChart.ctx.moveTo(d+l,1),a.myChart.ctx.lineTo(d+l,s),a.myChart.ctx.stroke(),a.myChart.ctx.restore(),a.myChart.ctx.font="normal 23px Arial",a.myChart.ctx.textBaseline="middle",a.myChart.ctx.fillStyle=a.colors.MODERATE,a.myChart.ctx.fillText(a.lineIndicatorText,d+20,s+70)}var f,y}}),bt(this,"fadeChartPlugin",{afterDatasetsDraw:function(t){t.ctx,t.canvas,t.data;var e=t.chartArea,r=(e.top,e.bottom),i=(e.left,e.right),o=(e.width,e.height,t.scales);if(o.x,o.y,a.isChartClicked){var n=t.ctx;t.scales.y,t.scales.x,n.save(),n.fillStyle=a.colors.FADE_CHART_ONCLICK,n.fillRect(2,2,i,r-2),n.restore()}}}),bt(this,"hoverCursorValuesXYPlugin",{afterEvent:function(t,e){t.ctx,t.canvas,t.data;var r=t.chartArea,i=(r.top,r.bottom,r.left,r.right,r.width,r.height,t.scales);i.x,i.y,e.inChartArea?(a.xHoverCoor=e.event.x,a.yHoverCoor=e.event.y):(a.xHoverCoor=void 0,a.yHoverCoor=void 0),e.changed=!0}}),bt(this,"clickOnChartEnableHoverPlugin",{afterEvent:function(t,e){var r=e.event.x;if("click"===e.event.type){t.ctx,t.data;for(var i=t.chartArea,o=(i.top,i.bottom,i.left,i.right,t.scales),n=(o.x,o.y,0);n<t._metasets[0].data.length;n++){var s=t._metasets[0].data[n].x-8,l=t._metasets[0].data[n].x+8;if(r>=s&&r<=l){if(a.isChartClicked)return void(a.isChartClicked=!1);a.isChartClicked=!0;break}}}}}),bt(this,"lineColorChangeOnThresholdPlugin",{afterLayout:function(t){var e=t.ctx;e.save();var r=t.scales.y,i=e.createLinearGradient(0,r.top,0,r.bottom);i.addColorStop(0,a.colors.HIGH),i.addColorStop(a.getThreshold(a.thresholds.HIGH-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.HIGH),i.addColorStop(a.getThreshold(a.thresholds.HIGH-.5-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.MODERATE),i.addColorStop(a.getThreshold(a.thresholds.MODERATE-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.MODERATE),i.addColorStop(a.getThreshold(a.thresholds.MODERATE-.5-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.LOW),i.addColorStop(a.getThreshold(a.thresholds.LOW-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.LOW),i.addColorStop(a.getThreshold(a.thresholds.LOW-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.MIN),i.addColorStop(1,a.colors.MIN),t.data.datasets[0].borderColor=i,e.restore()}}),bt(this,"customXAxisLabelColorPlugin",{beforeDraw:function(t,e,r){var i=t.scales.x,o=i.top,n=(i.bottom,t.chartArea.left),s=t.chartArea.right,l=t.ctx;l.fillStyle=a.colors.X_AXIS_LABELS,l.fillRect(2,o,s+n-5,49)}}),bt(this,"noDataTextPlugin",{afterDraw:function(t){var e,r=!1,i=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=pt(t))){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}(t.data.datasets);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(o.data.length>0&&o.data.some((function(t){return 0!==t}))){r=!0;break}}}catch(t){i.e(t)}finally{i.f()}if(!r){var n=t.chartArea,s=n.left,l=n.top,h=n.right,c=n.bottom,u=t.ctx,d=(s+h)/2,f=(l+c)/2;u.save(),u.textAlign="center",u.font="40px Arial",u.fillStyle="black",u.textBaseline="middle",u.fillText(a.noDataText,d,f),u.restore()}}}),this.colors={MIN:"rgb(255, 197, 88)",LOW:"rgb(0, 185, 255)",MODERATE:"rgb(144, 112, 255)",HIGH:"rgb(38, 203, 168)",X_AXIS_LABELS:"rgb(237, 239, 240)",HOVER_RECTANGLE:"rgba(237, 239, 240,0.3)",FADE_CHART_ONCLICK:"rgba(255, 255, 255, 0.7)"},this.lineWidthValues={NOW_INDICATOR_LINE:3,HOVER_LINE:2,CHART_LINE:2,BORDER_LINE:1},this.myChart,this.xHoverCoor,this.yHoverCoor,this.isChartClicked=!1,this.chartCanvas=e,this.heartRateData=[],this.is12HourFormat=!0,this.maxValue=220,this.isLineIndicatorOn=!0,this.lineIndicatorText="NOW",this.noDataText="NO DATA",this.connectDuration=10,this.isConnectAllPoints=!0,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:94,MODERATE:115,HIGH:153,MAX:250,FIXED_MAX:300},this.initializeChart()}var e,a;return e=t,(a=[{key:"initializeChart",value:function(){var t=this,e={labels:[],datasets:[{label:"",data:[],tension:.1,pointRadius:0,pointHoverRadius:0,borderWidth:this.lineWidthValues.CHART_LINE,spanGaps:!1,placeLine:"00:00",placeLineInPixels:0}]},a={type:"line",data:e,options:{animation:{duration:0},layout:{padding:{bottom:50}},responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"hour"},min:new Date("2024-01-01T00:00:00"),max:new Date("2024-01-02T00:00:00"),display:!0,grid:{drawOnChartArea:!1,display:!1,drawBorder:!1},border:{display:!1},ticks:{offset:!1,autoSkip:!1,callback:function(e,a,r){switch(a){case 0:return t.is12HourFormat?"12:00AM":"00:00";case 6:return t.is12HourFormat?"06:00AM":"06:00";case 12:return t.is12HourFormat?"12:00PM":"12:00";case 18:return t.is12HourFormat?"06:00PM":"18:00";case 24:return t.is12HourFormat?"11:59PM":"23:59";default:return}},maxRotation:0,minRotation:0,color:"black",padding:8,font:{weight:"normal",size:20}}},y:{min:this.thresholds.ADJUSTABLE_MIN,max:this.thresholds.MAX,border:{display:!1},ticks:{stepSize:1,maxTicksLimit:2*this.thresholds.MAX,color:"black",font:{weight:"bold",size:20},callback:function(a,r){if(0!==e.datasets[0].data.length)return a===t.thresholds.LOW||a===t.thresholds.MODERATE||a===t.thresholds.HIGH?a:void 0},gridLines:{drawBorder:!1}}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.customLineBorderPlugin,this.nowIndicatorLinePlugin,this.hoverCursorValuesXYPlugin,this.fadeChartPlugin,this.hoverLineAndTextPlugin,this.clickOnChartEnableHoverPlugin,this.lineColorChangeOnThresholdPlugin,this.customXAxisLabelColorPlugin,this.noDataTextPlugin]};this.myChart=new Chart(this.chartCanvas,a)}},{key:"showChart",value:function(){}},{key:"setChartData",value:function(t){this.heartRateData=t,this.updateChart()}},{key:"addMultipleData",value:function(t){var e;(e=this.heartRateData).push.apply(e,mt(t)),this.updateChart()}},{key:"addData",value:function(t){this.heartRateData.push(t),this.updateChart()}},{key:"updateChart",value:function(){this.myChart.data.datasets[0].data=[],this.convertToDates(),this.sortHeartRateDataByTime(),this.filterCorrectHRValues(),this.updateChartYMinMax(),this.updateChartData(),this.myChart.update(),console.log("Heart Rate Chart is rendered!")}},{key:"updateChartData",value:function(){for(var t,e=0;e<this.heartRateData.length;e++){var a=this.heartRateData[e];this.myChart.data.datasets[0].data.push({x:a.time,y:parseInt(a.hr)}),this.addGapIfRequired(e)}var r=null===(t=this.heartRateData[this.heartRateData.length-1])||void 0===t?void 0:t.time;r&&this.moveLineToLatest(r)}},{key:"addGapIfRequired",value:function(t){if(t+1<this.heartRateData.length){var e=(this.heartRateData[t+1].time-this.heartRateData[t].time)/6e4,a=this.isConnectAllPoints,r=this.connectDuration;if(!a&&e>r){var i=new Date(this.heartRateData[t].time.getTime()+6e4);this.myChart.data.datasets[0].data.push({x:i,y:null})}}}},{key:"convertToDates",value:function(){this.heartRateData.forEach((function(t){t.time instanceof Date||(t.time=new Date("2024-01-01T"+t.time))}))}},{key:"sortHeartRateDataByTime",value:function(){var t=new Date("2024-01-01T00:00:00").getTime(),e=new Date("2024-01-01T23:59:59").getTime();this.heartRateData=this.heartRateData.filter((function(a){var r=a.time.getTime();return r>=t&&r<=e})).sort((function(t,e){return t.time.getTime()-e.time.getTime()}))}},{key:"filterCorrectHRValues",value:function(){var t=this;this.heartRateData=this.heartRateData.filter((function(e){return e._hr>=0&&e._hr<=t.thresholds.MAX}))}},{key:"updateChartYMinMax",value:function(){if(0!==this.heartRateData.length){var t=Math.min.apply(Math,mt(this.heartRateData.map((function(t){return t.hr})))),e=Math.max.apply(Math,mt(this.heartRateData.map((function(t){return t.hr}))));t<=20?(this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0):(t>=this.thresholds.LOW?this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-20:this.thresholds.ADJUSTABLE_MIN=t-20,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN),e<=this.thresholds.HIGH?this.thresholds.ADJUSTABLE_MAX=this.thresholds.HIGH+20:this.thresholds.ADJUSTABLE_MAX=e+20,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX}else this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0}},{key:"setMaxValue",value:function(t){t>this.thresholds.FIXED_MAX?alert("Error value. Max value is 300"):t>=this.thresholds.HIGH?(this.myChart.options.scales.y.max=t,this.thresholds.MAX=t,this.myChart.update()):t<this.thresholds.HIGH&&alert("Error value. Max value should be higher than HIGH threshold")}},{key:"setFormat",value:function(t){"12HR"===t||"24HR"===t?(this.is12HourFormat="12HR"===t,this.updateChart()):alert("Error value. Values accepted are only 12HR and 24HR")}},{key:"deleteData",value:function(t){t>=this.heartRateData.length?alert("Error value. Cannot delete index from length of list value"):(this.heartRateData.splice(t,1),this.updateChart())}},{key:"moveLine",value:function(t){/^([01]\d|2[0-3]):([0-5]\d)$/.test(t)?0===this.heartRateData.length?alert("No data in chart."):(this.myChart.data.datasets[0].placeLine=t,this.myChart.update()):alert("Invalid time format. Please use military time format (HH:mm).")}},{key:"setThresholds",value:function(t,e,a){if(""===t||""===e||""===a)alert("Please enter correct values.");else{var r=parseInt(t),i=parseInt(e),o=parseInt(a);!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&r<=i&&i<=o&&o<=this.thresholds.MAX?(this.thresholds.LOW=r,this.thresholds.MODERATE=i,this.thresholds.HIGH=o,this.updateChartYMinMax(),this.myChart.update()):o>this.thresholds.MAX?alert("Current Max value is ".concat(this.thresholds.MAX,". High threshold should not be higher than that")):alert("Please enter valid threshold values.")}}},{key:"setTimeLineIndicatorToggle",value:function(t){"boolean"==typeof t&&(this.isLineIndicatorOn=!!t,this.myChart.update())}},{key:"setLineIndicator",value:function(t){this.lineIndicatorText=t,this.myChart.update()}},{key:"clearChart",value:function(){this.heartRateData=[],this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}},{key:"setConnectDuration",value:function(t){var e=parseInt(t,10);!isNaN(e)&&e>=1&&e<=1440?(this.connectDuration=e,this.updateChart()):alert("Please enter a valid duration (minimum 1 minute).")}},{key:"setConnectAllPoints",value:function(t){"boolean"==typeof t?(this.isConnectAllPoints=t,this.updateChart()):alert("Invalid parameter. Please provide a boolean value.")}},{key:"setNoDataText",value:function(t){""===t?alert("Error value. Please input something."):(this.noDataText=t,this.myChart.update())}},{key:"generateRandomHRArray",value:function(t,e,a,r){if(this.heartRateData.length>0){var i=this.heartRateData[this.heartRateData.length-1].time,o=i.getHours(),n=i.getMinutes(),s=i.getSeconds();(r=r||new Date("2024-01-01T00:00:00")).setHours(o,n,s)}else r=r||new Date("2024-01-01T00:00:00");for(var l=0;l<t;l++){var h=Math.floor(Math.random()*(a-e+1))+e;this.heartRateData.push(new ft(h,new Date(r))),r.setMinutes(r.getMinutes()+1)}}},{key:"moveLineToLatest",value:function(t){var e=new Date(t),a=e.getHours().toString().padStart(2,"0"),r=e.getMinutes().toString().padStart(2,"0");this.myChart.data.datasets[0].placeLine="".concat(a,":").concat(r)}},{key:"getThreshold",value:function(t,e){return 1-t/e}},{key:"formatDateTimeWithSeconds",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}}])&&gt(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}function Dt(t){return function(t){if(Array.isArray(t))return At(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return At(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?At(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function St(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Et(r.key),r)}}function Et(t){var e=function(t,e){if("object"!=Tt(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=Tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tt(e)?e:String(e)}const It=function(){function t(e){var a,r,i,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,i={afterLayout:function(t){var e=t.ctx;e.save();var a=t.scales.y,r=e.createLinearGradient(0,a.top,0,a.bottom);r.addColorStop(0,o.colors.HIGH),r.addColorStop(o.getThreshold(o.thresholds.HIGH-o.thresholds.ADJUSTABLE_MIN,a.max-o.thresholds.ADJUSTABLE_MIN),o.colors.HIGH),r.addColorStop(o.getThreshold(o.thresholds.HIGH-.5-o.thresholds.ADJUSTABLE_MIN,a.max-o.thresholds.ADJUSTABLE_MIN),o.colors.MODERATE),r.addColorStop(o.getThreshold(o.thresholds.MODERATE-o.thresholds.ADJUSTABLE_MIN,a.max-o.thresholds.ADJUSTABLE_MIN),o.colors.MODERATE),r.addColorStop(o.getThreshold(o.thresholds.MODERATE-.5-o.thresholds.ADJUSTABLE_MIN,a.max-o.thresholds.ADJUSTABLE_MIN),o.colors.LOW),r.addColorStop(o.getThreshold(o.thresholds.LOW-o.thresholds.ADJUSTABLE_MIN,a.max-o.thresholds.ADJUSTABLE_MIN),o.colors.LOW),r.addColorStop(o.getThreshold(o.thresholds.LOW-o.thresholds.ADJUSTABLE_MIN,a.max-o.thresholds.ADJUSTABLE_MIN),o.colors.MIN),r.addColorStop(1,o.colors.MIN),t.data.datasets[0].borderColor=r,e.restore()}},(r=Et(r="lineColorChangeOnThresholdPlugin"))in a?Object.defineProperty(a,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[r]=i,this.colors={MIN:"rgb(255, 197, 88)",LOW:"rgb(0, 185, 255)",MODERATE:"rgb(144, 112, 255)",HIGH:"rgb(38, 203, 168)"},this.myChart,this.chartCanvas=e,this.heartRateData=[],this.maxValue=220,this.connectDuration=10,this.isConnectAllPoints=!0,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:94,MODERATE:115,HIGH:153,MAX:250,FIXED_MAX:300},this.initializeChart()}var e,a;return e=t,(a=[{key:"initializeChart",value:function(){var t={type:"line",data:{labels:[],datasets:[{label:"",data:[],tension:.1,pointRadius:0,pointHoverRadius:0,borderWidth:1,spanGaps:!1}]},options:{animation:{duration:0},responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"hour"},min:new Date("2024-01-01T00:00:00"),max:new Date("2024-01-02T00:00:00"),display:!1},y:{min:this.thresholds.ADJUSTABLE_MIN,max:this.thresholds.MAX,border:{display:!1},display:!1}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.lineColorChangeOnThresholdPlugin]};this.myChart=new Chart(this.chartCanvas,t)}},{key:"showChart",value:function(){}},{key:"setChartData",value:function(t){this.heartRateData=t,this.updateChart()}},{key:"addMultipleData",value:function(t){var e;(e=this.heartRateData).push.apply(e,Dt(t)),this.updateChart()}},{key:"addData",value:function(t){this.heartRateData.push(t),this.updateChart()}},{key:"updateChart",value:function(){this.myChart.data.datasets[0].data=[],this.convertToDates(),this.sortHeartRateDataByTime(),this.filterCorrectHRValues(),this.updateChartYMinMax(),this.updateChartData(),this.myChart.update(),console.log("Tile Heart Rate Chart is rendered!")}},{key:"updateChartData",value:function(){for(var t=0;t<this.heartRateData.length;t++){var e=this.heartRateData[t];this.myChart.data.datasets[0].data.push({x:e.time,y:parseInt(e.hr)}),this.addGapIfRequired(t)}}},{key:"addGapIfRequired",value:function(t){if(t+1<this.heartRateData.length){var e=(this.heartRateData[t+1].time-this.heartRateData[t].time)/6e4,a=this.isConnectAllPoints,r=this.connectDuration;if(!a&&e>r){var i=new Date(this.heartRateData[t].time.getTime()+6e4);this.myChart.data.datasets[0].data.push({x:i,y:null})}}}},{key:"convertToDates",value:function(){this.heartRateData.forEach((function(t){t.time instanceof Date||(t.time=new Date("2024-01-01T"+t.time))}))}},{key:"sortHeartRateDataByTime",value:function(){var t=new Date("2024-01-01T00:00:00").getTime(),e=new Date("2024-01-01T23:59:59").getTime();this.heartRateData=this.heartRateData.filter((function(a){var r=a.time.getTime();return r>=t&&r<=e})).sort((function(t,e){return t.time.getTime()-e.time.getTime()}))}},{key:"filterCorrectHRValues",value:function(){var t=this;this.heartRateData=this.heartRateData.filter((function(e){return e._hr>=0&&e._hr<=t.thresholds.MAX}))}},{key:"updateChartYMinMax",value:function(){if(0!==this.heartRateData.length){var t=Math.min.apply(Math,Dt(this.heartRateData.map((function(t){return t.hr})))),e=Math.max.apply(Math,Dt(this.heartRateData.map((function(t){return t.hr}))));t<=20?(this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0):(t>=this.thresholds.LOW?this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-20:this.thresholds.ADJUSTABLE_MIN=t-20,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN),e<=this.thresholds.HIGH?this.thresholds.ADJUSTABLE_MAX=this.thresholds.HIGH+20:this.thresholds.ADJUSTABLE_MAX=e+20,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX}else this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0}},{key:"addDataToChart",value:function(t,e){if(""===t||""===e||isNaN(t))alert("Please enter correct values.");else if(parseInt(t)>this.thresholds.MAX)alert("Input exceeds max value. Please enter correct values.");else if(parseInt(t)<this.thresholds.MIN)alert("Input is below minimum value. Please enter correct values.");else{var a={hr:parseInt(t),time:new Date("2024-01-01T".concat(e))};this.heartRateData.push(a)}}},{key:"setMaxValue",value:function(t){t>this.thresholds.FIXED_MAX?alert("Error value. Max value is 300"):t>=this.thresholds.HIGH?(this.myChart.options.scales.y.max=t,this.thresholds.MAX=t,this.myChart.update()):t<this.thresholds.HIGH&&alert("Error value. Max value should be higher than HIGH threshold")}},{key:"setThresholds",value:function(t,e,a){if(""===t||""===e||""===a)alert("Please enter correct values.");else{var r=parseInt(t),i=parseInt(e),o=parseInt(a);!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&r<=i&&i<=o&&o<=this.thresholds.MAX?(this.thresholds.LOW=r,this.thresholds.MODERATE=i,this.thresholds.HIGH=o,this.updateChartYMinMax(),this.myChart.update()):o>this.thresholds.MAX?alert("Current Max value is ".concat(this.thresholds.MAX,". High threshold should not be higher than that")):alert("Please enter valid threshold values.")}}},{key:"deleteData",value:function(t){t>=this.heartRateData.length?alert("Error value. Cannot delete index from length of list value"):this.heartRateData.splice(t,1)}},{key:"clearChart",value:function(){this.heartRateData=[],this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}},{key:"setConnectDuration",value:function(t){var e=parseInt(t,10);!isNaN(e)&&e>=1&&e<=1440?(this.connectDuration=e,this.updateChart()):alert("Please enter a valid duration (minimum 1 minute).")}},{key:"setConnectAllPoints",value:function(t){"boolean"==typeof t?(this.isConnectAllPoints=t,this.updateChart()):alert("Invalid parameter. Please provide a boolean value.")}},{key:"generateRandomHRArray",value:function(t,e,a,r){if(this.heartRateData.length>0){var i=this.heartRateData[this.heartRateData.length-1].time,o=i.getHours(),n=i.getMinutes(),s=i.getSeconds();(r=r||new Date("2024-01-01T00:00:00")).setHours(o,n,s)}else r=r||new Date("2024-01-01T00:00:00");for(var l=0;l<t;l++){var h=Math.floor(Math.random()*(a-e+1))+e;this.heartRateData.push(new ft(h,new Date(r))),r.setMinutes(r.getMinutes()+1)}}},{key:"getThreshold",value:function(t,e){return 1-t/e}},{key:"formatDateTimeWithSeconds",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}}])&&St(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Lt(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mt(r.key),r)}}function Mt(t){var e=function(t,e){if("object"!=kt(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:String(e)}const wt=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._x=e,this._y=a}var e,a;return e=t,(a=[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}}])&&Lt(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Pt(t){return function(t){if(Array.isArray(t))return Nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Rt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){if(t){if("string"==typeof t)return Nt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Nt(t,e):void 0}}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function Ot(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bt(r.key),r)}}function _t(t,e,a){return(e=Bt(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Bt(t){var e=function(t,e){if("object"!=Ht(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ht(e)?e:String(e)}const Ft=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_t(this,"customXAxisLabelColorPlugin",{beforeDraw:function(t){var e=t.scales.x.top,r=t.chartArea.left,i=t.chartArea.right,o=t.ctx;o.fillStyle=a.colors.CUSTOM_X_AXIS,o.fillRect(r,e,i+r,70),o.save(),o.beginPath(),o.strokeStyle=a.colors.LINE,o.lineWidth=1,o.moveTo(r,e),o.lineTo(i+r,e),o.stroke(),o.restore()}}),_t(this,"lineIndicatorPlugin",{beforeDatasetsDraw:function(t){var e=t.ctx,r=(t.data,t.chartArea.bottom),i=t.scales,o=i.x;if(i.y,0!==t.data.datasets[0].data.length){e.save(),e.beginPath();var n=a.myChart.data.datasets[0].placeLine;if(a.filter===a.AverageRestingHRFilter.WEEKLY){if(n>7||n<0)return}else if(a.filter===a.AverageRestingHRFilter.MONTHLY){if(n>30||n<0)return}else if(a.filter===a.AverageRestingHRFilter.YEARLY&&(n>365||n<0))return;e.strokeStyle=a.colors.LINE,e.lineWidth=2,e.moveTo(o.getPixelForTick(n),0),e.lineTo(o.getPixelForTick(n),r),e.stroke()}}}),_t(this,"noDataTextPlugin",{afterDraw:function(t){var e,r=!1,i=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Rt(t))){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}(t.data.datasets);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(o.data.length>0&&o.data.some((function(t){return 0!==t}))){r=!0;break}}}catch(t){i.e(t)}finally{i.f()}if(!r){var n=t.chartArea,s=n.left,l=n.top,h=n.right,c=n.bottom,u=t.ctx,d=(t.scales.x,(s+h)/2),f=(l+c)/2;u.save(),u.textAlign="center",u.font="40px Arial",u.fillStyle="black",u.textBaseline="middle",u.fillText(a.noDataText,d,f),u.restore()}}}),_t(this,"hoverCursorValuesXYPlugin",{afterEvent:function(t,e){t.ctx,t.canvas,t.data;var r=t.chartArea,i=(r.top,r.bottom,r.left,r.right,r.width,r.height,t.scales);i.x,i.y,e.inChartArea?(a.xHoverCoor=e.event.x,a.yHoverCoor=e.event.y):(a.xHoverCoor=void 0,a.yHoverCoor=void 0),e.changed=!0}}),_t(this,"clickAndChangeLinePositionPlugin",{afterEvent:function(t,e){var r=e.event.x,i=(e.event.y,e.event.type),o=8;if(a.filter===a.AverageRestingHRFilter.YEARLY&&(o=4),"click"===i){t.ctx,t.data;for(var n=t.chartArea,s=(n.top,n.bottom,n.left,n.right,t.scales),l=(s.x,s.y,0);l<t._metasets[0].data.length;l++){var h=t._metasets[0].data[l].x-o,c=t._metasets[0].data[l].x+o;if(r>=h&&r<=c){var u=t._metasets[0].data[l].$context.raw.x,d=a.myChart.options.scales.x.min.getTime(),f=(u.getTime()-d)/864e5;a.moveLineToLatest(f)}}}}}),this.chartCanvas=e,this.myChart,this.noDataText="NOT ENOUGH HR DATA",this.filter,this.startDate,this.endDate,this.todayDate=new Date,this.aveRestingHRData=[],this.lowestDateScrolling,this.highestDateScrolling,this.dayCounter=0,this.xHoverCoor,this.yHoverCoor,this.dragThreshold=120,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:80,MODERATE:100,HIGH:120,ADJUSTABLE_MAX:200,FIXED_MAX:300},this.colors={LINE:"rgb(111, 111, 111)",POINTER:"rgb(42, 192, 238)",POINTER_RADIUS:"rgb(147, 147, 147)",CUSTOM_X_AXIS:"rgb(237, 239, 240)"},this.AverageRestingHRFilter={WEEKLY:0,MONTHLY:1,YEARLY:2};var r={type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:this.colors.POINTER,borderColor:this.colors.POINTER_RADIUS,borderWidth:2,pointStyle:"circle",pointRadius:7,pointHoverRadius:7,pointBorderColor:"black",placeLine:0}]},options:{animation:{duration:0},responsive:!0,maintainAspectRatio:!1,scaleShowValues:!0,scales:{x:{max:366,offset:!0,type:"time",grid:{display:!1},time:{unit:"day",displayFormats:{day:"MM/dd"}},border:{display:!1},ticks:_t(_t(_t(_t(_t(_t({maxRotation:0,stepSize:1,source:"date",autoSkip:!0,callback:function(t,e,r){var i=new Date(t),o=i.getMonth(),n=i.getDate(),s=o+1+"/"+String(n).padStart(2,"0");return a.filter===a.AverageRestingHRFilter.WEEKLY?s:a.filter!==a.AverageRestingHRFilter.MONTHLY||(e-2+a.dayCounter)%7!=0&&e-2+a.dayCounter!==0?a.filter===a.AverageRestingHRFilter.YEARLY?a.getMonth(o,n):"":s}},"maxRotation",0),"minRotation",0),"color",this.colors.LINE),"padding",10),"font",{weight:"normal",size:15}),"autoSkip",!1)},y:{min:this.thresholds.ADJUSTABLE_MIN,border:{display:!1},grid:{lineWidth:1,color:this.colors.LINE},ticks:{stepSize:1,color:this.colors.LINE,font:{weight:"normal",size:15},callback:function(t,e){if(t===a.thresholds.LOW||t===a.thresholds.MODERATE||t===a.thresholds.HIGH)return t}}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.customXAxisLabelColorPlugin,this.lineIndicatorPlugin,this.noDataTextPlugin,this.hoverCursorValuesXYPlugin,this.clickAndChangeLinePositionPlugin]};this.myChart=new Chart(this.chartCanvas,r),this.myChart.canvas.addEventListener("mousedown",(function(t){a.isMouseDown=!0,a.startX=t.clientX})),document.addEventListener("mouseup",(function(){a.isMouseDown&&(a.isMouseDown=!1)})),this.myChart.canvas.addEventListener("mousemove",(function(t){if(a.isMouseDown){a.endX=t.clientX;var e=a.endX-a.startX;Math.abs(e)>a.dragThreshold&&(e>0?a.scrollChart("left"):a.scrollChart("right"),a.startX=a.endX)}})),this.updateChartXMinMax(this.AverageRestingHRFilter.WEEKLY),this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}var e,a;return e=t,(a=[{key:"scrollChart",value:function(t){this.scroller(t)}},{key:"scroller",value:function(t){if(0!==this.myChart.data.datasets[0].data.length&&0!==this.aveRestingHRData){var e=864e5;t.deltaY>0||"right"===t?this.myChart.options.scales.x.max.getTime()+e<=this.highestDateScrolling.getTime()&&(this.myChart.options.scales.x.min=new Date(this.myChart.options.scales.x.min.getTime()+e),this.myChart.options.scales.x.max=new Date(this.myChart.options.scales.x.max.getTime()+e),this.dayCounter++,this.myChart.data.datasets[0].placeLine--):(t.deltaY<0||"left"===t)&&this.myChart.options.scales.x.min.getTime()-e>=this.lowestDateScrolling.getTime()&&(this.myChart.options.scales.x.min=new Date(this.myChart.options.scales.x.min.getTime()-e),this.myChart.options.scales.x.max=new Date(this.myChart.options.scales.x.max.getTime()-e),this.dayCounter--,this.myChart.data.datasets[0].placeLine++),this.myChart.update(),7!==this.dayCounter&&7!==this.dayCounter||(this.dayCounter=0)}}},{key:"moveLineToLatest",value:function(t){this.myChart.data.datasets[0].placeLine=t}},{key:"setTodayDate",value:function(t){/^\d{4}-\d{2}-\d{2}$/.test(t)?this.todayDate=new Date(t):(alert("Error: Invalid date format. Setting the date to today."),this.todayDate=new Date),this.updateChartXMinMax(this.filter),this.updateChartYMinMax(),this.myChart.update()}},{key:"setFilter",value:function(t){this.filter=t}},{key:"setChartData",value:function(t,e){this.aveRestingHRData=t,this.updateChart(e)}},{key:"addMultipleData",value:function(t,e){var a;(a=this.aveRestingHRData).push.apply(a,Pt(t)),this.updateChart(e)}},{key:"addData",value:function(t,e){this.aveRestingHRData.push(t),this.updateChart(e)}},{key:"setFilterView",value:function(t){this.updateChart(t)}},{key:"updateChart",value:function(t){this.myChart.data.datasets[0].data=[],this.updateChartXMinMax(t),this.convertToDates(),this.sortData(),this.filterCorrectHRValues(),this.updateChartYMinMax();for(var e=0;e<this.aveRestingHRData.length;e++){var a=this.aveRestingHRData[e].y;"string"==typeof a&&(a=parseInt(a)),this.myChart.data.datasets[0].data.push({x:this.aveRestingHRData[e].x,y:a})}this.myChart.update()}},{key:"getFormatDate",value:function(t){var e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(a,"-").concat(r,"T00:00:00")}},{key:"convertToDates",value:function(){this.aveRestingHRData.forEach((function(t){t.x instanceof Date||(t.x=new Date(t.x+"T00:00:00"))}))}},{key:"sortData",value:function(){this.aveRestingHRData.sort((function(t,e){return t.x.getTime()-e.x.getTime()}))}},{key:"filterCorrectHRValues",value:function(){var t=this;this.aveRestingHRData=this.aveRestingHRData.filter((function(e){return e.y>=0&&e.y<=t.thresholds.MAX}))}},{key:"getMonth",value:function(t,e){var a=" ";switch(t){case 0:1===e&&(a="JAN");break;case 1:1===e&&(a="FEB");break;case 2:1===e&&(a="MAR");break;case 3:1===e&&(a="APR");break;case 4:1===e&&(a="MAY");break;case 5:1===e&&(a="JUN");break;case 6:1===e&&(a="JUL");break;case 7:1===e&&(a="AUG");break;case 8:1===e&&(a="SEP");break;case 9:1===e&&(a="OCT");break;case 10:1===e&&(a="NOV");break;case 11:1===e&&(a="DEC");break;default:a=" "}return a}},{key:"updateChartXMinMax",value:function(t){this.endDate=this.todayDate,this.endDate.setHours(0),this.endDate.setMinutes(0),this.endDate.setSeconds(0),this.endDate.setMilliseconds(0),this.startDate=new Date(this.endDate),this.setFilter(t),this.dayCounter=0,this.filter===this.AverageRestingHRFilter.WEEKLY?(this.startDate.setDate(this.startDate.getDate()-7),this.moveLineToLatest(7),this.dragThreshold=120):this.filter===this.AverageRestingHRFilter.MONTHLY?(this.startDate.setDate(this.startDate.getDate()-30),this.moveLineToLatest(30),this.dragThreshold=80):this.filter===this.AverageRestingHRFilter.YEARLY&&(this.startDate.setDate(this.startDate.getDate()-365),this.moveLineToLatest(365),this.dragThreshold=20),this.myChart.options.scales.x.min=this.startDate,this.myChart.options.scales.x.max=this.endDate}},{key:"updateChartYMinMax",value:function(){if(0!==this.aveRestingHRData.length){var t=Math.min.apply(Math,Pt(this.aveRestingHRData.map((function(t){return t.y})))),e=Math.max.apply(Math,Pt(this.aveRestingHRData.map((function(t){return t.y}))));t<=20?(this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0):(t>=this.thresholds.LOW?this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-20:this.thresholds.ADJUSTABLE_MIN=t-20,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN),e<=this.thresholds.HIGH?this.thresholds.ADJUSTABLE_MAX=this.thresholds.HIGH+20:this.thresholds.ADJUSTABLE_MAX=e+20,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX;var a=this.aveRestingHRData.map((function(t){return new Date(t.x)}));this.lowestDateScrolling=new Date(Math.min.apply(Math,Pt(a))),this.highestDateScrolling=new Date(Math.max.apply(Math,Pt(a))),this.highestDateScrolling<this.todayDate&&(this.highestDateScrolling=this.todayDate);var r=this.todayDate-this.lowestDateScrolling,i=0;if(this.filter===this.AverageRestingHRFilter.WEEKLY?i=7:this.filter===this.AverageRestingHRFilter.MONTHLY?i=30:this.filter===this.AverageRestingHRFilter.YEARLY&&(i=365),r<=24*i*60*60*1e3&&r>=0){var o=new Date(this.todayDate);o.setDate(o.getDate()-i),this.lowestDateScrolling=o}}else this.thresholds.LOW<=20?this.thresholds.ADJUSTABLE_MIN=0:this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-20,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN,this.thresholds.MAX=this.thresholds.HIGH+20,this.myChart.options.scales.y.max=this.thresholds.MAX}},{key:"setNoDataText",value:function(t){""===t?alert("Error value. Please input something."):(this.noDataText=t,this.myChart.update())}},{key:"setThresholds",value:function(t,e,a){if(""===t||""===e||""===a)alert("Please enter correct values.");else{var r=parseInt(t),i=parseInt(e),o=parseInt(a);!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&r<=i&&i<=o?(this.thresholds.LOW=r,this.thresholds.MODERATE=i,this.thresholds.HIGH=o,this.updateChartYMinMax(),this.myChart.update()):alert("Please enter valid threshold values.")}}},{key:"clearChart",value:function(){console.log("Clearing..."),this.aveRestingHRData=[],this.updateChartXMinMax(this.AverageRestingHRFilter.WEEKLY),this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}}])&&Ot(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Ut(t){return function(t){if(Array.isArray(t))return jt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Wt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(t,e){if(t){if("string"==typeof t)return jt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?jt(t,e):void 0}}function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function Vt(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gt(r.key),r)}}function Yt(t,e,a){return(e=Gt(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Gt(t){var e=function(t,e){if("object"!=Xt(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=Xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xt(e)?e:String(e)}const Jt=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Yt(this,"hoverLineAndTextPlugin",{afterDatasetsDraw:function(t){var e=t.ctx,r=(t.canvas,t.data),i=t.chartArea,o=i.top,n=i.bottom,s=i.left,l=i.right,h=(i.width,i.height),c=t.scales,u=(c.x,c.y);if(a.xHoverCoor&&a.yHoverCoor)for(var d=0;d<t._metasets[0].data.length;d++){var f=void 0,y=void 0,m=t._metasets[0].data[d].x-1,p=t._metasets[0].data[d].x+1;if(a.xHoverCoor>=m&&a.xHoverCoor<=p){t.ctx.save(),t.ctx.beginPath();var v=void 0,g=t._metasets[0].data[d].$context.raw.y,b=t._metasets[0].data[d].$context.raw.x;if(null!==g&&a.isChartClicked){f=g,y=b,g>=a.thresholds.ADJUSTABLE_MIN&&g<a.thresholds.LOW?v=a.colors.MIN:g>=a.thresholds.LOW&&g<a.thresholds.MODERATE?v=a.colors.LOW:g>=a.thresholds.MODERATE&&g<a.thresholds.HIGH?v=a.colors.MODERATE:g>=a.thresholds.HIGH&&g<=a.thresholds.MAX&&(v=a.colors.HIGH),t.ctx.strokeStyle=v,t.ctx.lineWidth=a.lineWidthValues.HOVER_LINE,t.ctx.moveTo(a.xHoverCoor,o-20),t.ctx.lineTo(a.xHoverCoor,n),t.ctx.stroke(),t.ctx.restore();var C=h/3-f;C<o&&(C=o);var x=a.xHoverCoor-100,T=x+28;a.xHoverCoor<100+s?T=(x=s)+28:a.xHoverCoor>l-100&&(T=28+(x=l-200)),t.ctx.beginPath(),e.arc(a.xHoverCoor,u.getPixelForValue(g),5,0,2*Math.PI),e.borderWidth=5,e.borderColor="white",e.fillStyle=v,e.fill(),e.closePath(),t.ctx.beginPath(),t.ctx.fillStyle=v,t.ctx.roundRect(x-3,C-3,206,46,0),t.ctx.fill(),t.ctx.beginPath(),t.ctx.fillStyle="white",t.ctx.roundRect(x,C,200,40,0),t.ctx.fill(),t.ctx.beginPath(),e.arc(T-10,C+22,5,0,2*Math.PI),e.fillStyle=v,e.fill(),e.closePath(),t.ctx.font="bold 20px sans-serif";var D=new Date(y),A=D.getHours(),S=A>=12?"PM":"AM",E=(A%12||12).toString().padStart(2,"0"),I=D.getMinutes().toString().padStart(2,"0"),k="".concat(E,":").concat(I).concat(S),L=t.ctx.measureText("".concat(f," bpm ")).width;t.ctx.fillStyle="black",t.ctx.fillText("".concat(f," bpm "),T,C+23),t.ctx.font="20px sans-serif",t.ctx.fillText(k,T+L,C+23);break}v="rgba(255,255,255,0)"}else a.isChartClicked&&a.xHoverCoor+1>r.datasets[0].placeLineInPixels&&(t.ctx.save(),t.ctx.beginPath(),t.ctx.strokeStyle=a.colors.MIN,t.ctx.lineWidth=a.lineWidthValues.HOVER_LINE,t.ctx.moveTo(a.xHoverCoor,o-20),t.ctx.lineTo(a.xHoverCoor,n),t.ctx.stroke(),t.ctx.restore())}}}),Yt(this,"nowIndicatorLinePlugin",{beforeDatasetsDraw:function(t){if(!1!==a.isLineIndicatorOn&&0!==t._metasets[0].data.length){var e=t.ctx,r=t.data,i=t.chartArea,o=(i.top,i.bottom),n=i.left,s=i.right,l=t.scales;l.x,l.y,e.save(),a.myChart.ctx.beginPath(),a.myChart.ctx.strokeStyle=a.colors.MODERATE,a.myChart.ctx.lineWidth=a.lineWidthValues.NOW_INDICATOR_LINE;var h=(u=r.datasets[0].placeLine.split(":").map(Number),d=2,function(t){if(Array.isArray(t))return t}(u)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var r,i,o,n,s=[],l=!0,h=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(r=o.call(a)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=a.return&&(n=a.return(),Object(n)!==n))return}finally{if(h)throw i}}return s}}(u,d)||Wt(u,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=(60*h[0]+h[1])/1440*(s-n);r.datasets[0].placeLineInPixels=c+n,a.myChart.ctx.moveTo(c+n,1),a.myChart.ctx.lineTo(c+n,o),a.myChart.ctx.stroke(),a.myChart.ctx.restore(),a.myChart.ctx.font="normal 23px Arial",a.myChart.ctx.textBaseline="middle",a.myChart.ctx.fillStyle=a.colors.MODERATE,a.myChart.ctx.fillText(a.lineIndicatorText,c+20,o+70)}var u,d}}),Yt(this,"fadeChartPlugin",{afterDatasetsDraw:function(t){t.ctx,t.canvas,t.data;var e=t.chartArea,r=(e.top,e.bottom),i=(e.left,e.right),o=(e.width,e.height,t.scales);if(o.x,o.y,a.isChartClicked){var n=t.ctx;t.scales.y,t.scales.x,n.save(),n.fillStyle=a.colors.FADE_CHART_ONCLICK,n.fillRect(2,2,i,r-2),n.restore()}}}),Yt(this,"hoverCursorValuesXYPlugin",{afterEvent:function(t,e){t.ctx,t.canvas,t.data;var r=t.chartArea,i=(r.top,r.bottom,r.left,r.right,r.width,r.height,t.scales);i.x,i.y,e.inChartArea?(a.xHoverCoor=e.event.x,a.yHoverCoor=e.event.y):(a.xHoverCoor=void 0,a.yHoverCoor=void 0),e.changed=!0}}),Yt(this,"clickOnChartEnableHoverPlugin",{afterEvent:function(t,e){var r=e.event.x;if("click"===e.event.type){t.ctx,t.data;for(var i=t.chartArea,o=(i.top,i.bottom,i.left,i.right,t.scales),n=(o.x,o.y,0);n<t._metasets[0].data.length;n++){var s=t._metasets[0].data[n].x-8,l=t._metasets[0].data[n].x+8;if(r>=s&&r<=l){if(a.isChartClicked)return void(a.isChartClicked=!1);a.isChartClicked=!0;break}}}}}),Yt(this,"lineColorChangeOnThresholdPlugin",{afterLayout:function(t){var e=t.ctx;e.save();var r=t.scales.y,i=e.createLinearGradient(0,r.top,0,r.bottom);i.addColorStop(0,a.colors.HIGH),i.addColorStop(a.getThreshold(a.thresholds.HIGH-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.HIGH),i.addColorStop(a.getThreshold(a.thresholds.HIGH-.5-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.MODERATE),i.addColorStop(a.getThreshold(a.thresholds.MODERATE-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.MODERATE),i.addColorStop(a.getThreshold(a.thresholds.MODERATE-.5-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.LOW),i.addColorStop(a.getThreshold(a.thresholds.LOW-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.LOW),i.addColorStop(a.getThreshold(a.thresholds.LOW-a.thresholds.ADJUSTABLE_MIN,r.max-a.thresholds.ADJUSTABLE_MIN),a.colors.MIN),i.addColorStop(1,a.colors.MIN),t.data.datasets[0].borderColor=i,e.restore()}}),Yt(this,"noDataTextPlugin",{afterDraw:function(t){var e,r=!1,i=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Wt(t))){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}(t.data.datasets);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(o.data.length>0&&o.data.some((function(t){return 0!==t}))){r=!0;break}}}catch(t){i.e(t)}finally{i.f()}if(!r){var n=t.chartArea,s=n.left,l=n.top,h=n.right,c=n.bottom,u=t.ctx,d=(t.scales.x,(s+h)/2),f=(l+c)/2;u.save(),u.strokeStyle=a.colors.X_AXIS_LABELS,u.lineWidth=2,u.strokeRect(2,l+2,h+s-4,c-l),u.textAlign="center",u.font="40px Arial",u.fillStyle=a.colors.X_AXIS_LABELS,u.textBaseline="middle",u.fillText(a.noDataText,d,f),u.restore()}}}),this.colors={MIN:"rgb(255, 197, 88)",LOW:"rgb(0, 185, 255)",MODERATE:"rgb(144, 112, 255)",HIGH:"rgb(38, 203, 168)",X_AXIS_LABELS:"rgb(128, 128, 128)",HOVER_RECTANGLE:"rgba(237, 239, 240,0.3)",FADE_CHART_ONCLICK:"rgba(255, 255, 255, 0.7)"},this.lineWidthValues={NOW_INDICATOR_LINE:3,HOVER_LINE:2,CHART_LINE:3,BORDER_LINE:2},this.myChart,this.xHoverCoor,this.yHoverCoor,this.isChartClicked=!1,this.chartCanvas=e,this.paiEarnedData=[],this.is12HourFormat=!0,this.maxValue=220,this.isLineIndicatorOn=!0,this.lineIndicatorText="NOW",this.noDataText="NO DATA",this.connectDuration=10,this.isConnectAllPoints=!0,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:94,MODERATE:115,HIGH:153,MAX:250,FIXED_MAX:300},this.initializeChart()}var e,a;return e=t,(a=[{key:"initializeChart",value:function(){var t=this,e={labels:[],datasets:[{label:"",data:[],tension:.1,pointRadius:0,pointHoverRadius:0,borderWidth:this.lineWidthValues.CHART_LINE,spanGaps:!1,placeLine:"00:00",placeLineInPixels:0}]},a={type:"line",data:e,options:{animation:{duration:0},layout:{padding:{bottom:50}},responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"hour",autoSkip:!1},min:new Date("2024-01-01T00:00:00"),max:new Date("2024-01-02T00:00:00"),display:!0,grid:{drawOnChartArea:!1,display:!1,drawBorder:!1},border:{display:!1},ticks:{offset:!1,callback:function(e,a,r){var i=new Date(e);if(a%4==0){var o,n=i.getHours();return t.is12HourFormat?(o=(n%12||12).toString(),o+=n<12?"am":"pm"):o=n.toString().padStart(2,"0"),o}},maxRotation:0,minRotation:0,color:"black",padding:8,font:{weight:"normal",size:20}}},y:{min:this.thresholds.ADJUSTABLE_MIN,max:this.thresholds.MAX,border:{display:!1},ticks:{stepSize:1,maxTicksLimit:2*this.thresholds.MAX,color:"black",font:{weight:"bold",size:20},callback:function(a,r){if(0!==e.datasets[0].data.length)return a===t.thresholds.LOW||a===t.thresholds.MODERATE||a===t.thresholds.HIGH?a:void 0},gridLines:{drawBorder:!1}}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.nowIndicatorLinePlugin,this.hoverCursorValuesXYPlugin,this.fadeChartPlugin,this.hoverLineAndTextPlugin,this.clickOnChartEnableHoverPlugin,this.lineColorChangeOnThresholdPlugin,this.noDataTextPlugin]};this.myChart=new Chart(this.chartCanvas,a)}},{key:"setChartData",value:function(t){this.paiEarnedData=t,this.updateChart()}},{key:"addMultipleData",value:function(t){var e;(e=this.paiEarnedData).push.apply(e,Ut(t)),this.updateChart()}},{key:"addData",value:function(t){this.paiEarnedData.push(t),this.updateChart()}},{key:"updateChart",value:function(){this.myChart.data.datasets[0].data=[],this.convertToDates(),this.sortPAIEarnedDataByTime(),this.filterCorrectHRValues(),this.updateChartYMinMax(),this.updateChartData(),this.myChart.update(),console.log("PAI Earned Chart is rendered!")}},{key:"updateChartData",value:function(){for(var t,e=0;e<this.paiEarnedData.length;e++){var a=this.paiEarnedData[e];this.myChart.data.datasets[0].data.push({x:a.time,y:parseInt(a.hr)}),this.addGapIfRequired(e)}var r=null===(t=this.paiEarnedData[this.paiEarnedData.length-1])||void 0===t?void 0:t.time;r&&this.moveLineToLatest(r)}},{key:"addGapIfRequired",value:function(t){if(t+1<this.paiEarnedData.length){var e=(this.paiEarnedData[t+1].time-this.paiEarnedData[t].time)/6e4,a=this.isConnectAllPoints,r=this.connectDuration;if(!a&&e>r){var i=new Date(this.paiEarnedData[t].time.getTime()+6e4);this.myChart.data.datasets[0].data.push({x:i,y:null})}}}},{key:"convertToDates",value:function(){this.paiEarnedData.forEach((function(t){t.time instanceof Date||(t.time=new Date("2024-01-01T"+t.time))}))}},{key:"sortPAIEarnedDataByTime",value:function(){var t=new Date("2024-01-01T00:00:00").getTime(),e=new Date("2024-01-01T23:59:59").getTime();this.paiEarnedData=this.paiEarnedData.filter((function(a){var r=a.time.getTime();return r>=t&&r<=e})).sort((function(t,e){return t.time.getTime()-e.time.getTime()}))}},{key:"filterCorrectHRValues",value:function(){var t=this;this.paiEarnedData=this.paiEarnedData.filter((function(e){return e._hr>=0&&e._hr<=t.thresholds.MAX}))}},{key:"updateChartYMinMax",value:function(){if(0!==this.paiEarnedData.length){var t=Math.min.apply(Math,Ut(this.paiEarnedData.map((function(t){return t.hr})))),e=Math.max.apply(Math,Ut(this.paiEarnedData.map((function(t){return t.hr}))));t<=20?(this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0):(t>=this.thresholds.LOW?this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-20:this.thresholds.ADJUSTABLE_MIN=t-20,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN),e<=this.thresholds.HIGH?this.thresholds.ADJUSTABLE_MAX=this.thresholds.HIGH+20:this.thresholds.ADJUSTABLE_MAX=e+20,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX}else this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0}},{key:"setMaxValue",value:function(t){t>this.thresholds.FIXED_MAX?alert("Error value. Max value is 300"):t>=this.thresholds.HIGH?(this.myChart.options.scales.y.max=t,this.thresholds.MAX=t,this.myChart.update()):t<this.thresholds.HIGH&&alert("Error value. Max value should be higher than HIGH threshold")}},{key:"setFormat",value:function(t){"12HR"===t||"24HR"===t?(this.is12HourFormat="12HR"===t,this.myChart.update()):alert("Error value. Values accepted are only 12HR and 24HR")}},{key:"deleteData",value:function(t){t>=this.paiEarnedData.length?alert("Error value. Cannot delete index from length of list value"):(this.paiEarnedData.splice(t,1),this.updateChart())}},{key:"moveLine",value:function(t){/^([01]\d|2[0-3]):([0-5]\d)$/.test(t)?0===this.paiEarnedData.length?alert("No data in chart."):(this.myChart.data.datasets[0].placeLine=t,this.myChart.update()):alert("Invalid time format. Please use military time format (HH:mm).")}},{key:"setThresholds",value:function(t,e,a){if(""===t||""===e||""===a)alert("Please enter correct values.");else{var r=parseInt(t),i=parseInt(e),o=parseInt(a);!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&r<=i&&i<=o&&o<=this.thresholds.MAX?(this.thresholds.LOW=r,this.thresholds.MODERATE=i,this.thresholds.HIGH=o,this.updateChartYMinMax(),this.myChart.update()):o>this.thresholds.MAX?alert("Current Max value is ".concat(this.thresholds.MAX,". High threshold should not be higher than that")):alert("Please enter valid threshold values.")}}},{key:"setTimeLineIndicatorToggle",value:function(t){"boolean"==typeof t&&(this.isLineIndicatorOn=!!t,this.myChart.update())}},{key:"setLineIndicator",value:function(t){this.lineIndicatorText=t,this.myChart.update()}},{key:"clearChart",value:function(){this.paiEarnedData=[],this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}},{key:"setConnectDuration",value:function(t){var e=parseInt(t,10);!isNaN(e)&&e>=1&&e<=1440?(this.connectDuration=e,this.updateChart()):alert("Please enter a valid duration (minimum 1 minute).")}},{key:"setConnectAllPoints",value:function(t){"boolean"==typeof t?(this.isConnectAllPoints=t,this.updateChart()):alert("Invalid parameter. Please provide a boolean value.")}},{key:"setNoDataText",value:function(t){""===t?alert("Error value. Please input something."):(this.noDataText=t,this.myChart.update())}},{key:"generateRandomHRArray",value:function(t,e,a,r){if(this.paiEarnedData.length>0){var i=this.paiEarnedData[this.paiEarnedData.length-1].time,o=i.getHours(),n=i.getMinutes(),s=i.getSeconds();(r=r||new Date("2024-01-01T00:00:00")).setHours(o,n,s)}else r=r||new Date("2024-01-01T00:00:00");for(var l=0;l<t;l++){var h=Math.floor(Math.random()*(a-e+1))+e;this.paiEarnedData.push(new ft(h,new Date(r))),r.setMinutes(r.getMinutes()+1)}}},{key:"moveLineToLatest",value:function(t){var e=new Date(t),a=e.getHours().toString().padStart(2,"0"),r=e.getMinutes().toString().padStart(2,"0");this.myChart.data.datasets[0].placeLine="".concat(a,":").concat(r)}},{key:"getThreshold",value:function(t,e){return 1-t/e}},{key:"formatDateTimeWithSeconds",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}}])&&Vt(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Kt(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$t(r.key),r)}}function $t(t){var e=function(t,e){if("object"!=zt(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:String(e)}const qt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._pai=e}var e,a;return e=t,(a=[{key:"pai",get:function(){return this._pai},set:function(t){this._pai=t}}])&&Kt(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function Zt(t){return function(t){if(Array.isArray(t))return te(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return te(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?te(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function ee(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,re(r.key),r)}}function ae(t,e,a){return(e=re(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function re(t){var e=function(t,e){if("object"!=Qt(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=Qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qt(e)?e:String(e)}const ie=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ae(this,"lineGoalPlugin",{beforeDatasetsDraw:function(t){var e=t.ctx,r=(t.data,t.chartArea),i=(r.top,r.bottom,r.left),o=r.right,n=t.scales,s=(n.x,n.y),l=a.thresholds.GOAL;if(l){var h=s.getPixelForValue(l);e.save(),e.beginPath(),e.strokeStyle=a.colors.GOAL_LEVEL,e.lineWidth=2,e.moveTo(i-10,h),e.lineTo(o,h),e.stroke(),e.restore()}}}),ae(this,"clickOnChartEnableHoverPlugin",{afterEvent:function(t,e){var r=e.event.x;if("click"===e.event.type){t.ctx,t.data;var i=t.chartArea,o=(i.top,i.bottom,i.left,i.right,t.scales);if(o.x,o.y,a.filter!==a.PAIHistoryFilter.WEEKLY)return void(a.isChartClicked=!0);for(var n=0;n<t._metasets[0].data.length;n++){var s=t._metasets[0].data[n].x-8,l=t._metasets[0].data[n].x+8;if(r>=s&&r<=l){if(!0===a.isChartClicked)return void(a.isChartClicked=!1);a.isChartClicked=!0;break}}}}}),ae(this,"hoverLineAndTextPlugin",{afterDatasetsDraw:function(t){var e=t.ctx,r=t.chartArea,i=r.top,o=r.bottom,n=r.left,s=r.right,l=t.scales,h=l.x,c=l.y;if(a.filter===a.PAIHistoryFilter.WEEKLY&&a.xHoverCoor&&a.yHoverCoor)for(var u=function(){var r=t._metasets[0].data[d].x,l=r-20,u=r+20;if(a.xHoverCoor>=l&&a.xHoverCoor<=u){var f=r,y=a.paiHistoryData[d];if(a.dataPointIsHovered=!0,t.ctx.save(),t.ctx.beginPath(),!0===a.isChartClicked){var m=t._metasets[0].data[d].$context.raw.x.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"2-digit",year:"numeric"});return a.drawIndicators(e,f,c.getPixelForValue(y),i,o,a.colors.INDICATOR_LINE),a.drawCustomTooltip(e,f,c.getPixelForValue(y),y,m,a.colors),t.ctx.restore(),1}}else for(var p=h.ticks.map((function(t){return t.value})),v={weekday:"short",month:"short",day:"2-digit",year:"numeric"},g=p.map((function(t){return new Date(t).toLocaleDateString("en-US",v)})),b=(s-n)/7,C=t._metasets[0].data[0].x,x=1;x<7;x++){var T=(C+=b)-20,D=C+20;a.xHoverCoor>=T&&a.xHoverCoor<=D&&(void 0!==a.paiHistoryData[x]&&!isNaN(a.paiHistoryData[x])||!0!==a.isChartClicked||(a.dataPointIsHovered=!0,a.drawIndicators(e,C,c.getPixelForValue(0),i,o,a.colors.INDICATOR_LINE),a.drawCustomTooltip(e,C,c.getPixelForValue(0),0,g[x],a.colors)))}},d=0;d<t._metasets[0].data.length&&!u();d++);}}),ae(this,"lineIndicatorPlugin",{afterDatasetsDraw:function(t){var e=t.ctx,r=t.chartArea,i=r.top,o=r.bottom,n=t.scales,s=n.x,l=n.y,h=t.data.datasets;if(0!==h[0].data.length&&a.isChartClicked&&!a.dataPointIsHovered){var c=h[0].placeLine,u=a.paiHistoryData[c],d=s.getPixelForTick(c),f=l.getPixelForValue(u);if(e.save(),e.beginPath(),a.drawIndicators(e,d,f,i,o,a.colors.INDICATOR_LINE),a.filter===a.PAIHistoryFilter.WEEKLY){var y=t._metasets[0].data[c].$context.raw.x.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"2-digit",year:"numeric"});a.drawCustomTooltip(e,s.getPixelForTick(c),l.getPixelForValue(u),u,y,a.colors)}e.restore()}}}),ae(this,"hoverCursorValuesXYPlugin",{afterEvent:function(t,e){e.inChartArea?(a.xHoverCoor=e.event.x,a.yHoverCoor=e.event.y):(a.xHoverCoor=void 0,a.yHoverCoor=void 0),e.changed=!0}}),ae(this,"clickAndChangeLinePositionPlugin",{afterEvent:function(t,e){var r=e.event.x;if(e.event.y,"click"===e.event.type&&a.filter===a.PAIHistoryFilter.WEEKLY){t.ctx,t.data;for(var i=t.chartArea,o=(i.top,i.bottom,i.left,i.right,t.scales),n=(o.x,o.y,0);n<t._metasets[0].data.length;n++){var s=t._metasets[0].data[n].x-10,l=t._metasets[0].data[n].x+10;if(r>=s&&r<=l){var h=t._metasets[0].data[n].$context.raw.x,c=a.myChart.options.scales.x.min.getTime(),u=(h.getTime()-c)/864e5;a.moveLineToLatest(u)}}}}}),this.chartCanvas=e,this.myChart,this.filter,this.startDate,this.endDate,this.todayDate=new Date,this.paiHistoryData=[],this.dayCounter=0,this.xHoverCoor,this.yHoverCoor,this.isChartClicked=!0,this.thresholds={MIN:0,GOAL:100,ADJUSTABLE_MAX:150},this.colors={LINE:"rgb(111, 111, 111)",POINTER_RADIUS:"rgb(144, 112, 255)",LINE_DEFAULT:"#5C00D4",INDICATOR_LINE:"#9070FF",LEVEL_LINES:"#D9D2F8",GOAL_LEVEL:"#26CBA8"},this.PAIHistoryFilter={WEEKLY:0,MONTHLY:1,YEARLY:2};var r={type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:this.colors.LINE_DEFAULT,borderColor:this.colors.LINE_DEFAULT,borderWidth:2,pointStyle:"circle",pointHoverRadius:0,pointRadius:0,placeLine:0}]},options:{animation:{duration:0},layout:{padding:{left:50,right:50,top:50,bottom:50}},responsive:!0,maintainAspectRatio:!1,scaleShowValues:!0,scales:{x:{max:366,offset:!0,type:"time",grid:{display:!1},time:{unit:"day",displayFormats:{day:"MM/dd"}},border:{display:!1},ticks:ae(ae(ae(ae(ae(ae({maxRotation:0,stepSize:1,source:"date",autoSkip:!0,callback:function(t,e,r){var i=new Date(t),o=i.getMonth(),n=i.getDate(),s=i.getFullYear();if(a.filter===a.PAIHistoryFilter.WEEKLY)return i.getDate();if(a.filter===a.PAIHistoryFilter.MONTHLY){var l=i.getDate(),h=a.daysInMonth(i.getMonth()+1,i.getFullYear());return l%5==0&&l<=25||1===l||l===h?(l<10?"0":"")+l:" "}return a.filter===a.PAIHistoryFilter.YEARLY?a.getMonth(o,n,s):" "}},"maxRotation",0),"minRotation",0),"color",this.colors.LINE),"padding",10),"font",{weight:"normal",size:15}),"autoSkip",!1)},y:{min:this.thresholds.MIN,max:this.thresholds.ADJUSTABLE_MAX,border:{display:!1},grid:{lineWidth:2,color:this.colors.LEVEL_LINES},ticks:{stepSize:1,autoSkip:!1,color:this.colors.LINE,font:{weight:"normal",size:15},callback:function(t,e){if(0===t||t%50==0)return t}}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.lineGoalPlugin,this.lineIndicatorPlugin,this.hoverCursorValuesXYPlugin,this.clickAndChangeLinePositionPlugin,this.hoverLineAndTextPlugin,this.clickOnChartEnableHoverPlugin]};this.myChart=new Chart(this.chartCanvas,r),this.updateChartXMinMax(this.PAIHistoryFilter.WEEKLY),this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}var e,a;return e=t,(a=[{key:"drawIndicators",value:function(t,e,a,r,i,o){t.strokeStyle=o,t.lineWidth=3,t.beginPath(),t.moveTo(e,r),t.lineTo(e,i),t.stroke(),t.beginPath(),t.arc(e,a,6,0,2*Math.PI),t.lineWidth=5,t.fillStyle="white",t.fill(),t.beginPath(),t.arc(e,a,5,0,2*Math.PI),t.fillStyle=o,t.fill()}},{key:"drawCustomTooltip",value:function(t,e,a,r,i,o){t.beginPath(),t.fillStyle=o.POINTER_RADIUS,t.roundRect(e-76,a-61,157,52,3),t.moveTo(e,a+2),t.lineTo(e-30,a-30),t.lineTo(e+30,a-30),t.fill(),t.beginPath(),t.fillStyle="white",t.roundRect(e-75,a-60,155,50,3),t.moveTo(e,a),t.lineTo(e-10,a-10),t.lineTo(e+10,a-10),t.fill(),t.fillStyle="black",t.fillText(i,e-60,a-40),t.fillText("PAI Score ".concat(r," PAI"),e-48,a-20),t.beginPath(),t.strokeStyle=o.LINE_DEFAULT,t.lineWidth=3,t.moveTo(e-65,a-25),t.lineTo(e-55,a-25),t.stroke()}},{key:"moveLineToLatest",value:function(t){this.myChart.data.datasets[0].placeLine=t}},{key:"daysInMonth",value:function(t,e){return new Date(e,t,0).getDate()}},{key:"setTodayDate",value:function(t){/^\d{4}-\d{2}-\d{2}$/.test(t)?this.todayDate=new Date(t):(alert("Error: Invalid date format. Setting the date to today."),this.todayDate=new Date),this.updateChart(this.filter)}},{key:"setFilter",value:function(t){this.filter=t}},{key:"setChartData",value:function(t,e){this.paiHistoryData=t,this.updateChart(e)}},{key:"addMultipleData",value:function(t,e){var a;(a=this.paiHistoryData).push.apply(a,Zt(t)),this.updateChart(e)}},{key:"addData",value:function(t,e){this.paiHistoryData.push(t),this.updateChart(e)}},{key:"setFilterView",value:function(t){this.updateChart(t)}},{key:"updateChart",value:function(t){this.myChart.data.datasets[0].data=[],this.convertToInts(),this.updateChartXMinMax(t),this.updateChartYMinMax();for(var e=[],a=new Date(this.startDate),r=0;r<this.paiHistoryData.length;r++){var i={x:new Date(a),y:this.paiHistoryData[r]};e.push(i),this.myChart.data.datasets[0].data.push(i),a.setDate(a.getDate()+1),a.setHours(0,0,0,0)}var o=this.paiHistoryData.length-1;-1===o?this.moveLineToLatest(0):this.moveLineToLatest(o);var n=this.getNumDaysDifference();(this.filter===this.PAIHistoryFilter.WEEKLY&&this.paiHistoryData.length>n||this.filter===this.PAIHistoryFilter.MONTHLY&&this.paiHistoryData.length>n||this.filter===this.PAIHistoryFilter.YEARLY&&this.paiHistoryData.length>n)&&(this.myChart.data.datasets[0].placeLine=n),this.isChartClicked=!0,this.dataPointIsHovered=!1,this.myChart.update(),console.log("PAI History Chart rendered!")}},{key:"getNumDaysDifference",value:function(){var t=this.startDate,e=(this.endDate.getTime()-t.getTime())/864e5;return Math.round(e)}},{key:"convertToInts",value:function(){for(var t=0;t<this.paiHistoryData.length;t++)this.paiHistoryData[t]=parseInt(this.paiHistoryData[t])}},{key:"setGoal",value:function(t){isNaN(t)?alert("Goal should be an integer."):(this.thresholds.GOAL=t,this.myChart.update())}},{key:"getFormatDate",value:function(t){var e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(a,"-").concat(r,"T00:00:00")}},{key:"getMonth",value:function(t,e,a){var r=" ";switch(t){case 0:1===e&&(r=["Jan",a]);break;case 2:1===e&&(r=["Mar",a]);break;case 4:1===e&&(r=["May",a]);break;case 6:1===e&&(r=["Jul",a]);break;case 8:1===e&&(r=["Sep",a]);break;case 10:1===e&&(r=["Nov",a]);break;default:r=""}return r}},{key:"updateChartXMinMax",value:function(t){if(this.filter=t,t===this.PAIHistoryFilter.WEEKLY){var e=this.todayDate.getDay(),a=new Date(this.todayDate);a.setDate(this.todayDate.getDate()-e),a.setHours(0,0,0,0);var r=new Date(a);r.setDate(a.getDate()+6),r.setHours(0,0,0,0),this.startDate=a,this.endDate=r}else if(t===this.PAIHistoryFilter.MONTHLY){var i=new Date(this.todayDate);i.setDate(1),i.setHours(0,0,0,0);var o=new Date(i.getFullYear(),i.getMonth()+1,0);o.setHours(0,0,0,0),this.startDate=i,this.endDate=o}else if(t===this.PAIHistoryFilter.YEARLY){var n=this.todayDate.getFullYear(),s=new Date(n,0,1),l=new Date(n,11,31);this.startDate=s,this.endDate=l}this.myChart.options.scales.x.min=this.startDate,this.myChart.options.scales.x.max=this.endDate}},{key:"updateChartYMinMax",value:function(){if(0!==this.paiHistoryData.length){var t=Math.max.apply(Math,Zt(this.paiHistoryData.slice(0,this.getNumDaysDifference()+1))),e=this.thresholds.ADJUSTABLE_MAX;t>e||e-t<50||e-t>150?(this.thresholds.ADJUSTABLE_MAX=50*Math.ceil(t/50)+50,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX):t<100&&(this.thresholds.ADJUSTABLE_MAX=150,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX)}else this.thresholds.ADJUSTABLE_MAX=150,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX}},{key:"clearChart",value:function(){console.log("Chart is cleared!"),this.paiHistoryData=[],this.updateChartXMinMax(this.PAIHistoryFilter.WEEKLY),this.updateChartYMinMax(),this.myChart.data.datasets[0].data=[],this.myChart.update()}}])&&ee(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ne(t){return function(t){if(Array.isArray(t))return le(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||se(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(t,e){if(t){if("string"==typeof t)return le(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?le(t,e):void 0}}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function he(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ue(r.key),r)}}function ce(t,e,a){return(e=ue(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ue(t){var e=function(t,e){if("object"!=oe(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oe(e)?e:String(e)}const de=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ce(this,"highlightDataPoint",{beforeDatasetsDraw:function(t,e,r){var i=t.ctx,o=(t.data,t.chartArea),n=(o.top,o.bottom,o.left,o.right),s=t.scales,l=s.x,h=s.y;if(0!==t.data.datasets[0].data.length){i.save(),i.beginPath();var c=a.myChart.data.datasets[0].placeRadius,u=l.getPixelForValue(c.x),d=h.getPixelForValue(c.y);u>n||!a.isDataHighlighted||(i.arc(u,d,6,0,2*Math.PI),i.fillStyle=a.colors.POINTER,i.fill())}}}),ce(this,"noDataTextPlugin",{afterDraw:function(t,e,r){var i,o=!1,n=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=se(t))){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}(t.data.datasets);try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.data.length>0&&s.data.some((function(t){return 0!==t}))){o=!0;break}}}catch(t){n.e(t)}finally{n.f()}if(!o){var l=t.chartArea,h=l.left,c=l.top,u=l.right,d=l.bottom,f=t.ctx,y=(t.scales.x,(h+u)/2),m=(c+d)/2;f.save(),f.textAlign="center",f.font="40px Arial",f.fillStyle="black",f.textBaseline="middle",f.fillText(a.noDataText,y,m),f.restore()}}}),ce(this,"hoverCursorValuesXYPlugin",{afterEvent:function(t){t.inChartArea?(a.xHoverCoor=t.event.x,a.yHoverCoor=t.event.y):(a.xHoverCoor=void 0,a.yHoverCoor=void 0),t.changed=!0}}),ce(this,"clickAndChangeLinePositionPlugin",{afterEvent:function(t,e){var r=e.event.x;if(e.event.y,"click"===e.event.type){t.ctx,t.data;var i=t.chartArea,o=(i.top,i.bottom,i.left,i.right,t.scales);if(o.x,o.y,!a.isMoreThan29Days)return;for(var n=0;n<t._metasets[0].data.length;n++){var s=t._metasets[0].data[n].x-10,l=t._metasets[0].data[n].x+10;if(r>=s&&r<=l){var h={x:new Date(t._metasets[0].data[n].$context.parsed.x),y:t._metasets[0].data[n].$context.parsed.y},c=a.myChart.data.datasets[0].placeRadius;h.x.getTime()===c.x.getTime()&&a.isDataHighlighted?a.isDataHighlighted=!1:(a.myChart.data.datasets[0].placeRadius=h,a.isDataHighlighted=!0)}a.myChart.update()}}}}),this.chartCanvas=e,this.myChart,this.noDataText="NO DATA",this.startDate,this.endDate,this.todayDate=new Date,this.fitnessAgeData=[],this.lowestDateScrolling,this.highestDateScrolling,this.xHoverCoor,this.yHoverCoor,this.isMouseDown=!1,this.startX=0,this.endX=0,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:55,MODERATE:60,HIGH:65,ADJUSTABLE_MAX:100},this.colors={LINE:"rgb(111, 111, 111)",GRID_LINE:"rgb(236, 236, 236)",POINTER:"rgb(144, 112, 255)",POINTER_RADIUS:"rgb(147, 147, 147)",CUSTOM_X_AXIS:"rgb(237, 239, 240)"};var r={type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:this.colors.POINTER,pointRadius:3,pointHoverRadius:0,borderWidth:0,placeRadius:{}}]},options:{tooltips:{enabled:!1},hover:{mode:null},animation:{duration:0},responsive:!0,maintainAspectRatio:!1,scaleShowValues:!0,scales:{x:{max:366,offset:!0,type:"time",grid:{display:!1},time:{unit:"day",displayFormats:{day:"MM/dd"}},border:{display:!1},ticks:ce(ce(ce(ce(ce(ce({maxRotation:0,stepSize:1,source:"date",autoSkip:!0,callback:function(t,e,a){return""}},"maxRotation",0),"minRotation",0),"color",this.colors.LINE),"padding",10),"font",{weight:"normal",size:15}),"autoSkip",!1)},y:{position:"right",min:this.thresholds.LOW-5,max:this.thresholds.HIGH+5,border:{display:!1},grid:{lineWidth:2,color:this.colors.GRID_LINE},ticks:{stepSize:1,autoSkip:!1,color:this.colors.LINE,font:{weight:"normal",size:15},callback:function(t,e){if(t===a.thresholds.LOW||t===a.thresholds.MODERATE||t===a.thresholds.HIGH)return t}}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.noDataTextPlugin,this.hoverCursorValuesXYPlugin,this.clickAndChangeLinePositionPlugin,this.highlightDataPoint]};this.myChart=new Chart(this.chartCanvas,r),this.myChart.canvas.addEventListener("mousedown",(function(t){a.isMouseDown=!0,a.startX=t.clientX})),document.addEventListener("mouseup",(function(){a.isMouseDown&&(a.isMouseDown=!1)})),this.myChart.canvas.addEventListener("mousemove",(function(t){if(a.isMouseDown){a.endX=t.clientX;var e=a.endX-a.startX;Math.abs(e)>25&&(e>0?a.scrollChart("left"):a.scrollChart("right"),a.startX=a.endX)}})),this.updateChartXMinMax(),this.updateChartLevels(),this.myChart.data.datasets[0].data=[],this.myChart.update()}var e,a;return e=t,(a=[{key:"scrollChart",value:function(t){this.scroller(t)}},{key:"scroller",value:function(t){if(0!==this.myChart.data.datasets[0].data.length&&0!==this.fitnessAgeData){var e=864e5;t.deltaY>0||"right"===t?this.myChart.options.scales.x.max.getTime()+e<=this.highestDateScrolling.getTime()&&(this.myChart.options.scales.x.min=new Date(this.myChart.options.scales.x.min.getTime()+e),this.myChart.options.scales.x.max=new Date(this.myChart.options.scales.x.max.getTime()+e)):(t.deltaY<0||"left"===t)&&this.myChart.options.scales.x.min.getTime()-e>=this.lowestDateScrolling.getTime()&&(this.myChart.options.scales.x.min=new Date(this.myChart.options.scales.x.min.getTime()-e),this.myChart.options.scales.x.max=new Date(this.myChart.options.scales.x.max.getTime()-e)),console.log("scrolling .. min date"+this.myChart.options.scales.x.min),console.log("scrolling .. max date"+this.myChart.options.scales.x.max),this.myChart.update()}}},{key:"setTodayDate",value:function(t){/^\d{4}-\d{2}-\d{2}$/.test(t)?this.todayDate=new Date(t):(alert("Error: Invalid date format. Setting the date to today."),this.todayDate=new Date),this.updateChartXMinMax(),this.updateChartLevels(),this.myChart.update()}},{key:"setChartData",value:function(t){this.fitnessAgeData=t,this.updateChart()}},{key:"addMultipleData",value:function(t){var e;(e=this.fitnessAgeData).push.apply(e,ne(t)),this.updateChart()}},{key:"addData",value:function(t){this.fitnessAgeData.push(t),this.updateChart()}},{key:"updateChart",value:function(){this.myChart.data.datasets[0].data=[],this.updateChartXMinMax(),this.convertToDates(),this.sortData(),this.adjustIfScrollable(),this.updateChartLevels();for(var t=0;t<this.fitnessAgeData.length;t++){var e=this.fitnessAgeData[t].y;"string"==typeof e&&(e=parseInt(e)),this.myChart.data.datasets[0].data.push({x:this.fitnessAgeData[t].x,y:e})}this.fitnessAgeData[this.fitnessAgeData.length-1].x<=this.todayDate&&(this.myChart.data.datasets[0].placeRadius=this.fitnessAgeData[this.fitnessAgeData.length-1],this.isDataHighlighted=!0),this.myChart.update()}},{key:"adjustIfScrollable",value:function(){var t=this.fitnessAgeData.map((function(t){return new Date(t.x)}));this.lowestDateScrolling=new Date(Math.min.apply(Math,ne(t))),console.log(this.todayDate),this.highestDateScrolling=new Date(this.todayDate);var e=(this.highestDateScrolling.getTime()-this.lowestDateScrolling.getTime())/864e5;this.isMoreThan29Days=e>29,this.isMoreThan29Days?(this.myChart.data.datasets[0].borderWidth=3,this.myChart.data.datasets[0].borderColor=this.colors.POINTER,this.myChart.data.datasets[0].pointRadius=0,console.log("here"),this.endDate=this.lowestDateScrolling,this.endDate.setHours(0),this.endDate.setMinutes(0),this.endDate.setSeconds(0),this.endDate.setMilliseconds(0),this.startDate=new Date(this.endDate),this.startDate.setDate(this.startDate.getDate()+29),this.myChart.options.scales.x.min=this.endDate,this.myChart.options.scales.x.max=this.startDate):(this.myChart.data.datasets[0].borderWidth=0,this.myChart.data.datasets[0].pointRadius=3),console.log("lowest scrolling - "+this.lowestDateScrolling),console.log("highest scrolling - "+this.highestDateScrolling),console.log("min date"+this.myChart.options.scales.x.min),console.log("max date"+this.myChart.options.scales.x.max)}},{key:"convertToDates",value:function(){this.fitnessAgeData.forEach((function(t){t.x instanceof Date||(t.x=new Date(t.x+"T00:00:00"))}))}},{key:"sortData",value:function(){this.fitnessAgeData.sort((function(t,e){return t.x.getTime()-e.x.getTime()}))}},{key:"updateChartXMinMax",value:function(){this.endDate=this.todayDate,this.endDate.setHours(0),this.endDate.setMinutes(0),this.endDate.setSeconds(0),this.endDate.setMilliseconds(0),this.startDate=new Date(this.endDate),this.startDate.setDate(this.startDate.getDate()-29),this.myChart.options.scales.x.min=this.startDate,this.myChart.options.scales.x.max=this.endDate}},{key:"updateChartLevels",value:function(){if(0!==this.fitnessAgeData.length){var t=Math.min.apply(Math,ne(this.fitnessAgeData.map((function(t){return t.y})))),e=Math.max.apply(Math,ne(this.fitnessAgeData.map((function(t){return t.y})))),a=Math.round((e+t)/2);this.thresholds.LOW=t-5,this.thresholds.MODERATE=a,this.thresholds.HIGH=e+5}else this.thresholds.LOW=55,this.thresholds.MODERATE=60,this.thresholds.HIGH=65;this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-2,this.thresholds.ADJUSTABLE_MAX=this.thresholds.HIGH+2,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX}},{key:"setNoDataText",value:function(t){""===t?alert("Error value. Please input something."):(this.noDataText=t,this.myChart.update())}},{key:"setThresholds",value:function(t,e,a){if(""===t||""===e||""===a)alert("Please enter correct values.");else{var r=parseInt(t),i=parseInt(e),o=parseInt(a);!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&r<=i&&i<=o?(this.thresholds.LOW=r,this.thresholds.MODERATE=i,this.thresholds.HIGH=o,this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW-2,this.thresholds.ADJUSTABLE_MAX=this.thresholds.HIGH+2,this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN,this.myChart.options.scales.y.max=this.thresholds.ADJUSTABLE_MAX,this.myChart.update()):alert("Please enter valid threshold values.")}}},{key:"clearChart",value:function(){console.log("Clearing..."),this.fitnessAgeData=[],this.updateChartLevels(),this.myChart.data.datasets[0].data=[],this.myChart.update()}}])&&he(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function ye(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,me(r.key),r)}}function me(t){var e=function(t,e){if("object"!=fe(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,"string");if("object"!=fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fe(e)?e:String(e)}const pe=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timeStamp=e,this.heartRate=a}var e,a;return e=t,(a=[{key:"heartRate",get:function(){return this._heartRate},set:function(t){this._heartRate=t}},{key:"timeStamp",get:function(){return this._timeStamp},set:function(t){this._timeStamp=t}}])&&ye(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ve={NAME:"Timex JS Charts Library",VERSION:"v0.3.0",COMPANY:"Timex Group USA"};void 0!==(t=a.hmd(t)).exports?t.exports={TimeDisplayFormat:r,TimeInterval:i,StepCountInterval:l,StepCountBarChart:m,SleepQuality:p,SleepQualityInterval:C,SleepQualityBarChart:H,FitnessAgeBarChart:_,PAIScore:U,DailyPAIFilter:W,DailyPAIBarChart:Z,ActivityHistoryFilter:tt,ActivityHistoryBarChart:ht,HeartRateLineDataModel:ft,HeartRateLineChart:xt,TileHeartRateLineChart:It,AveRestingHRLineChartModel:wt,AveRestingHRLineChart:Ft,PAIEarnedLineChart:Jt,PAIHistoryLineDataModel:qt,PAIHistoryLineChart:ie,FitnessAgeLineChart:de,ChartLanguage:h,HeartRateInterval:pe,TimexCharts:ve}:(window.TimeDisplayFormat=r,window.TimeInterval=i,window.StepCountInterval=l,window.StepCountBarChart=m,window.SleepQuality=p,window.SleepQualityInterval=C,window.SleepQualityBarChart=H,window.FitnessAgeBarChart=_,window.PAIScore=U,window.DailyPAIFilter=W,window.DailyPAIBarChart=Z,window.ActivityHistoryFilter=tt,window.ActivityHistoryBarChart=ht,window.HeartRateLineDataModel=ft,window.HeartRateLineChart=xt,window.TileHeartRateLineChart=It,window.AveRestingHRLineChartModel=wt,window.AveRestingHRLineChart=Ft,window.PAIEarnedLineChart=Jt,window.PAIHistoryLineDataModel=qt,window.PAIHistoryLineChart=ie,window.FitnessAgeLineChart=de,window.ChartLanguage=h,window.HeartRateInterval=pe,window.TimexCharts=ve)}},e={};function a(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r](o,o.exports,a),o.loaded=!0,o.exports}return a.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a(856)})()));