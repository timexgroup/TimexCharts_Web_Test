!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.timexcharts=e():t.timexcharts=e()}(self,(()=>(()=>{"use strict";var t={671:(t,e,r)=>{r.r(e);const a={USE_12HR_FORMAT:0,USE_24HR_FORMAT:1,USE_SYSTEM_FORMAT:2},o={ONE_SECOND:86400,ONE_MINUTE:1440,FIVE_MINUTES:288,TEN_MINUTES:144,FIFTEEN_MINUTES:96,TWENTY_MINUTES:72,THIRTY_MINUTES:48,ONE_HOUR:24};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function i(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,s(a.key),a)}}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:String(e)}const l=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startTime=e,this.stepCount=r}var e,r;return e=t,(r=[{key:"stepCount",get:function(){return this._stepCount},set:function(t){this._stepCount=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}}])&&i(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function c(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,d(a.key),a)}}function d(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=h(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==h(e)?e:String(e)}const f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.barColor="#3EB1C8",this.timeFormat=a.USE_12HR_FORMAT,this.maxIntervalCount=o.ONE_SECOND,this.intervalUsed=o.ONE_SECOND,this.displayIntervalCount=o.FIFTEEN_MINUTES,this.defdata={labels:[""],datasets:[{data:[0],backgroundColor:this.barColor,borderColor:this.barColor,hoverBackgroundColor:this.barColor,borderWidth:0,barPercentage:1,categoryPercentage:1}]};var r={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{maxTicksLimit:24,callback:function(t,e,r){return r.length,""}}},y:{display:!1,beginAtZero:!0}},plugins:{tooltip:{enabled:!1},legend:{display:!1},customBackground:{enabled:!0,label1:"12:00 AM",label2:"12:00 PM",label3:"11:59 PM"}}}};this.addCustomXAxisLabels(),this.chart=new Chart(this.ctx,r)}var e,r;return e=t,(r=[{key:"addCustomXAxisLabels",value:function(){Chart.register({id:"customBackground",beforeDraw:function(t,e,r){var a=t.ctx,o=t.scales.x;a.save(),a.fillStyle="rgba(237, 239, 240, 1.0)",a.fillRect(0,t.chartArea.bottom,o.width,30),a.fillStyle="black",a.textAlign="center",a.fillText(r.label1,t.chartArea.left+30,t.chartArea.bottom+15),a.fillText(r.label2,o.width/2,t.chartArea.bottom+15),a.fillText(r.label3,t.chartArea.right-30,t.chartArea.bottom+15),a.restore()}})}},{key:"convertTimeToIndex",value:function(t){var e,r,a=t.split(":"),n=0,i=!1,s=0;switch(t.length>5&&(i=!0),e=Number(a[0]),r=Number(a[1]),1==i&&(n=Number(a[2])),this.maxIntervalCount){case o.ONE_SECOND:s=3600*e,s+=60*r,!0===i&&(s+=n);break;case o.ONE_MINUTE:s=60*e,s+=r;break;case o.FIVE_MINUTES:s=12*e,s+=r/5;break;case o.TEN_MINUTES:s=6*e,s+=r/10;break;case o.FIFTEEN_MINUTES:s=4*e,s+=r/15;break;case o.TWENTY_MINUTES:s=3*e,s+=r/20;break;case o.THIRTY_MINUTES:s=2*e,s+=r/30;break;case o.ONE_HOUR:s=e;break;default:s=0}return s}},{key:"setChartData",value:function(t){console.log("StepCountBarChart setChartData");var e=new Array(this.maxIntervalCount).fill(0),r=this.displayIntervalCount;if(this.displayIntervalCount>this.maxIntervalCount&&(r=this.maxIntervalCount),null!=t&&Array.isArray(t)&&t.length>0){this.setMaxIntervalCount(this.maxIntervalCount);var a,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,n=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw n}}}}(t);try{for(o.s();!(a=o.n()).done;){var n=a.value;e[this.convertTimeToIndex(n.startTime)]+=n.stepCount}}catch(t){o.e(t)}finally{o.f()}for(var i=new Array(r).fill(0),s=this.maxIntervalCount/r,l=0,h=0,c=0;c<r;c++)for(l=0;l<s;l++)i[c]+=e[h],h++;this.intervalUsed=this.displayIntervalCount,this.defdata.labels=new Array(r).fill(""),this.defdata.datasets[0].data=i,this.chart.update()}}},{key:"resetChart",value:function(){this.defdata.datasets[0].data=[],this.chart.update()}},{key:"setMaxStepsPerInterval",value:function(){console.log("StepCountBarChart setMaxStepsPerInterval")}},{key:"setMaxIntervalCount",value:function(t){this.maxIntervalCount=t}},{key:"setDisplayIntervalCount",value:function(t){this.displayIntervalCount=t}},{key:"getXAxisLabelsWithFormatting",value:function(t,e){switch(this.timeFormat){case a.USE_12HR_FORMAT:return t;case a.USE_24HR_FORMAT:return e;default:return t}}},{key:"setTimeDisplayFormat",value:function(t){this.timeFormat=t,this.chart.options.plugins.customBackground.label1=this.getXAxisLabelsWithFormatting("12:00 AM","00:00"),this.chart.options.plugins.customBackground.label2=this.getXAxisLabelsWithFormatting("12:00 PM","12:00"),this.chart.options.plugins.customBackground.label3=this.getXAxisLabelsWithFormatting("11:59 PM","23:59"),this.chart.update()}},{key:"setBarColor",value:function(t){this.barColor=t,this.defdata.datasets[0].backgroundColor=t,this.defdata.datasets[0].borderColor=t,this.chart.update()}}])&&c(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),m={AWAKE:0,LIGHT_SLEEP:1,DEEP_SLEEP:2,REM_SLEEP:3};function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function p(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,v(a.key),a)}}function v(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=y(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:String(e)}const b=function(){function t(e,r,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quality=e,this.startTime=r,this.endTime=a}var e,r;return e=t,(r=[{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}},{key:"endTime",get:function(){return this._endTime},set:function(t){this._endTime=t}},{key:"totalTime",get:function(){var t=new Date(this._startTime.replace(" ","T")+":00");return(new Date(this._endTime.replace(" ","T")+":00")-t)/6e4}}])&&p(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function T(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,C(a.key),a)}}function C(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=g(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:String(e)}const S=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quality=e.quality,this.startTime=e.startTime,this.endTime=e.endTime,this.startIndex=0,this.endIndex=0}var e,r;return e=t,(r=[{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}},{key:"endTime",get:function(){return this._endTime},set:function(t){this._endTime=t}},{key:"startIndex",get:function(){return this._startIndex},set:function(t){this._startIndex=t}},{key:"endIndex",get:function(){return this._endIndex},set:function(t){this._endIndex=t}},{key:"setIndices",value:function(t,e){this.startIndex=t,this.endIndex=e}}])&&T(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const A={ENGLISH:"en",SPANISH:"es",SYSTEM_LANGUAGE:"sys"};function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function E(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return I(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,n=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw n}}}}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function D(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,w(a.key),a)}}function w(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=x(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==x(e)?e:String(e)}const L=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.barColor="#FFFFFFFF",this.timeFormat=a.USE_12HR_FORMAT,this.maxIntervalCount=o.ONE_MINUTE,this.sleepStartTime="22:00",this.sleepEndTime="06:00",this.language=A.ENGLISH,this.defdata={labels:[""],datasets:[{data:[0],backgroundColor:this.barColor,borderColor:this.barColor,borderWidth:0,barPercentage:1,categoryPercentage:1}]};var r={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{maxTicksLimit:24,callback:function(t,e,r){return r.length,""}}},y:{display:!1,beginAtZero:!0}},plugins:{tooltip:{enabled:!1},legend:{display:!1},customXAxisLabels:{enabled:!0,label1:this.getXAxisLabelsWithFormatting(this.sleepStartTime),label2:this.getXAxisLabelsWithFormatting(this.sleepEndTime)},customNoDataBackground:{backgroundColor:"rgba(200, 200, 200, 0.5)",label:this.getLocalizedNoDataString(this.language),emptyChart:!0}}}};if("function"!=typeof Chart){var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/chart.js",document.head.appendChild(n)}this.addCustomXAxisLabels(),this.chart=new Chart(this.ctx,r)}var e,r;return e=t,r=[{key:"addCustomXAxisLabels",value:function(){Chart.register({id:"customXAxisLabels",beforeDraw:function(t,e,r){var a=t.ctx,o=t.scales.x;a.save(),a.fillStyle="rgba(237, 239, 240, 1.0)",a.fillRect(0,t.chartArea.bottom,o.width,30),a.fillStyle="black",a.textAlign="center",a.fillText(r.label1,t.chartArea.left+30,t.chartArea.bottom+15),a.fillText(r.label2,t.chartArea.right-30,t.chartArea.bottom+15),a.restore()}}),Chart.register({id:"customNoDataBackground",beforeDraw:function(t,e,r){if(console.log(r.emptyChart),!0===r.emptyChart){var a=t.ctx,o=(t.canvas,t.scales.x),n=t.chartArea;n.top,n.right,n.bottom,n.left,a.save(),a.fillStyle=r.backgroundColor,a.fillRect(0,0,o.width,t.chartArea.bottom),a.fillStyle="black",a.font="20px Arial",a.textAlign="center",a.textBaseline="middle",a.fillText(r.label,o.width/2,t.chartArea.bottom/2),a.restore()}}})}},{key:"updateChart",value:function(t,e,r){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=0,i=[],s=[],l=E(r);try{for(l.s();!(a=l.n()).done;){var h=a.value;n<this.maxIntervalCount&&(i.push(100),h===m.AWAKE?s.push("#FFFFFF"):h===m.LIGHT_SLEEP?s.push("#C3BEE3"):h===m.DEEP_SLEEP?s.push("#8551D3"):h===m.REM_SLEEP&&s.push("#3F098A"),n++)}}catch(t){l.e(t)}finally{l.f()}null!==o&&console.log("HR data is available"),this.defdata.labels=new Array(i.length).fill(""),this.defdata.datasets[0].data=i,this.defdata.datasets[0].backgroundColor=s,this.defdata.datasets[0].borderColor=s,this.defdata.datasets[0].hoverBackgroundColor=s,this.sleepStartTime=t.split(" ")[1],this.sleepEndTime=e.split(" ")[1],this.chart.options.plugins.customXAxisLabels.label1=this.getXAxisLabelsWithFormatting(this.sleepStartTime),this.chart.options.plugins.customXAxisLabels.label2=this.getXAxisLabelsWithFormatting(this.sleepEndTime),this.chart.options.plugins.customNoDataBackground.emptyChart=!1,this.chart.update()}},{key:"setChartData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!=t&&Array.isArray(t)&&t.length>0){var r=[];t.sort((function(t,e){var r=t.startTime,a=e.startTime;return r<a?-1:r>a?1:0}));for(var a=0;a<t.length;a++)if(a<t.length-1){var o=t[a].endTime,n=t[a+1].startTime;o!==n&&t.splice(a+1,0,new b(m.AWAKE,o,n))}var i,s=0,l=0,h=[],u=E(t);try{for(u.s();!(i=u.n()).done;){var c=i.value,d=new S(c);s=l;for(var f=0;f<c.totalTime;f++)r.push(c.quality),l++;d.setIndices(s,l-1),h.push(d)}}catch(t){u.e(t)}finally{u.f()}null!==e?this.updateChart(t[0].startTime,t[t.length-1].endTime,r,hrList):this.updateChart(t[0].startTime,t[t.length-1].endTime,r)}}},{key:"resetChart",value:function(){this.defdata.datasets[0].data=[],this.sleepStartTime="22:00",this.sleepEndTime="06:00",this.chart.options.plugins.customXAxisLabels.label1=this.getXAxisLabelsWithFormatting(this.sleepStartTime),this.chart.options.plugins.customXAxisLabels.label2=this.getXAxisLabelsWithFormatting(this.sleepEndTime),this.chart.options.plugins.customNoDataBackground.emptyChart=!0,this.chart.update()}},{key:"getXAxisLabelsWithFormatting",value:function(t){if(this.timeFormat===a.USE_12HR_FORMAT){var e=t.split(":"),r=parseInt(e[0],10),o=parseInt(e[1],10),n=r>=12?"PM":"AM";return((r=r%12==0?12:r%12)<10?"0":"")+r+":"+(o<10?"0":"")+o+" "+n}return t}},{key:"setTimeDisplayFormat",value:function(t){this.timeFormat=t,this.chart.options.plugins.customXAxisLabels.label1=this.getXAxisLabelsWithFormatting(this.sleepStartTime),this.chart.options.plugins.customXAxisLabels.label2=this.getXAxisLabelsWithFormatting(this.sleepEndTime),this.chart.update()}},{key:"getLocalizedNoDataString",value:function(t){return"es"===t?"Sin Datos":"No Data"}},{key:"setLanguage",value:function(t){this.language=t,this.chart.options.plugins.customNoDataBackground.label=this.getLocalizedNoDataString(t),this.chart.update()}}],r&&D(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();var M={BELOW_AVERAGE:0,FAIR:1,GOOD:2,VERY_GOOD:3,EXCELLENT:4};function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function R(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,k(a.key),a)}}function k(t){var e=function(t,e){if("object"!=N(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=N(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==N(e)?e:String(e)}const _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.ageValue=0,this.thresholdValue=[66,62,58,54];var r=["#EB5B59","#F7BD4C","#01B9FE","#9071FE","#26CBA8"];this.defdata={labels:["","","","",""],datasets:[{data:[12,12,12,12,12],backgroundColor:r,borderColor:r,hoverBackgroundColor:r,borderWidth:0,barPercentage:1,categoryPercentage:1}]};var a={type:"bar",data:this.defdata,options:{animation:!1,aspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{display:!1,maxTicksLimit:24}},y:{display:!1,beginAtZero:!0,max:35}},plugins:{tooltip:{enabled:!1},legend:{display:!1},selectedBarImage:{enabled:!1,barIndex:2,heartHeightRatio:1,heartWidthRatio:.6,heartColor:"white"}}}};if("function"!=typeof Chart){var o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/chart.js",document.head.appendChild(o)}this.addCustomChartPlugins(),this.chart=new Chart(this.ctx,a)}var e,r;return e=t,(r=[{key:"addCustomChartPlugins",value:function(){Chart.register({id:"selectedBarImage",afterDraw:function(t,e,r){var a=t.ctx,o=t.chartArea,n=t.options.plugins.selectedBarImage;if(n&&!0===n.enabled){var i=n.barIndex||0;if(i>=0&&i<t.data.labels.length){var s=t.getDatasetMeta(0).data[i].x,l=t.getDatasetMeta(0).data[i].width,h=o.height/1.3,u=l*n.heartWidthRatio,c=h*n.heartHeightRatio,d=n.heartColor||"red",f=s,m=o.top+h;a.fillStyle=d,a.beginPath(),a.moveTo(f,m-c/2),a.bezierCurveTo(f-u/3,m-c,f-u,m-c/3,f,m),a.bezierCurveTo(f+u,m-c/3,f+u/3,m-c,f,m-c/2),a.closePath(),a.fill()}}}})}},{key:"setAgeLevelThresholds",value:function(t,e,r,a){this.thresholdValue[0]=t,this.thresholdValue[1]=e,this.thresholdValue[2]=r,this.thresholdValue[3]=a,this.setChartData(this.ageValue)}},{key:"setChartData",value:function(t){var e,r=12,a=12,o=12,n=12,i=12;this.ageValue=t,0==t?e=M.NONE:t>this.thresholdValue[0]?(r=35,e=M.BELOW_AVERAGE):t>this.thresholdValue[1]?(a=35,e=M.FAIR):t>this.thresholdValue[2]?(o=35,e=M.GOOD):t>this.thresholdValue[3]?(n=35,e=M.VERY_GOOD):(i=35,e=M.EXCELLENT),this.chart.options.plugins.selectedBarImage.enabled=!0,this.chart.options.plugins.selectedBarImage.barIndex=e,this.defdata.datasets[0].data=[r,a,o,n,i],this.chart.update()}},{key:"resetChart",value:function(){this.chart.options.plugins.selectedBarImage.enabled=!1,this.defdata.datasets[0].data=[12,12,12,12,12],this.chart.update()}}])&&R(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,B(a.key),a)}}function H(t,e,r){return e&&P(t.prototype,e),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=O(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==O(e)?e:String(e)}const U=H((function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hr=e,this.time=r}));function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function j(t,e){if(t){if("string"==typeof t)return W(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W(t,e):void 0}}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function J(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,G(a.key),a)}}function X(t,e,r){return(e=G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G(t){var e=function(t,e){if("object"!=F(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=F(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:String(e)}const V=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),X(this,"hoverLineAndTextPlugin",{afterDatasetsDraw:function(t,e,a){var o=t.ctx,n=(t.canvas,t.data),i=t.chartArea,s=i.top,l=i.bottom,h=(i.left,i.right),u=(i.width,i.height,t.scales),c=(u.x,u.y);if(r.xHoverCoor&&r.yHoverCoor)for(var d=0;d<t._metasets[0].data.length;d++){var f=void 0,m=void 0,y=t._metasets[0].data[d].x-1,p=t._metasets[0].data[d].x+1;if(r.xHoverCoor>=y&&r.xHoverCoor<=p){t.ctx.save(),t.ctx.beginPath();var v=void 0,b=t._metasets[0].data[d].$context.raw.y,g=t._metasets[0].data[d].$context.raw.x;if(null!==b&&r.isChartClicked){f=b,m=g,b>=r.thresholds.ADJUSTABLE_MIN&&b<r.thresholds.LOW?v=r.colors.MIN:b>=r.thresholds.LOW&&b<r.thresholds.MODERATE?v=r.colors.LOW:b>=r.thresholds.MODERATE&&b<r.thresholds.HIGH?v=r.colors.MODERATE:b>=r.thresholds.HIGH&&b<=r.thresholds.MAX&&(v=r.colors.HIGH),t.ctx.strokeStyle=v,t.ctx.lineWidth=r.lineWidthValues.HOVER_LINE,t.ctx.moveTo(r.xHoverCoor,s-20),t.ctx.lineTo(r.xHoverCoor,l),t.ctx.stroke(),t.ctx.restore();var T=r.xHoverCoor+10,C=r.xHoverCoor+35;r.xHoverCoor>=h-200&&(T=r.xHoverCoor-220,C=r.xHoverCoor-190),t.ctx.beginPath(),o.arc(C-10,s+32,5,0,2*Math.PI),o.fillStyle=v,o.fill(),o.closePath(),t.ctx.beginPath(),o.arc(r.xHoverCoor,c.getPixelForValue(b),5,0,2*Math.PI),o.borderWidth=5,o.borderColor="white",o.fillStyle=v,o.fill(),o.closePath(),t.ctx.beginPath(),t.ctx.fillStyle=r.colors.HOVER_RECTANGLE,t.ctx.roundRect(T,s+10,200,40,3),t.ctx.fill(),t.ctx.font="bold 20px sans-serif",t.ctx.fillStyle="black";var S=new Date(m),A=S.getHours(),x=A>=12?"PM":"AM",E=(A%12||12).toString().padStart(2,"0"),I=S.getMinutes().toString().padStart(2,"0"),D="".concat(E,":").concat(I," ").concat(x);t.ctx.fillText("".concat(f," hr ").concat(D),C,s+35);break}v="rgba(255,255,255,0)"}else r.isChartClicked&&r.xHoverCoor+1>n.datasets[0].placeLineInPixels&&(t.ctx.save(),t.ctx.beginPath(),t.ctx.strokeStyle=r.colors.MIN,t.ctx.lineWidth=r.lineWidthValues.HOVER_LINE,t.ctx.moveTo(r.xHoverCoor,s-20),t.ctx.lineTo(r.xHoverCoor,l),t.ctx.stroke(),t.ctx.restore())}}}),X(this,"customLineBorderPlugin",{afterDatasetsDraw:function(t,e){t.canvas,t.data;var a=t.chartArea,o=(a.top,a.bottom),n=(a.left,a.right,a.width,a.height,t.scales),i=(n.x,n.y,r.chartCanvas.parentNode),s=i.offsetWidth,l=window.getComputedStyle(i),h=l.getPropertyValue("padding-left"),u=l.getPropertyValue("padding-right"),c=s-(parseInt(h,10)+parseInt(u,10))-6;isNaN(parseInt(h,10))&&(h=0),isNaN(parseInt(u,10))&&(h=0);var d=t.ctx;d.save(),d.beginPath(),d.fillStyle=r.colors.X_AXIS_LABELS,d.moveTo(0,0),d.lineTo(c,0),d.lineTo(c,o+50),d.lineTo(0,o+50),d.closePath(),d.stroke()}}),X(this,"nowIndicatorLinePlugin",{beforeDatasetsDraw:function(t,e,a){if(!1!==r.lineIndicator&&0!==t._metasets[0].data.length){var o=t.ctx,n=t.data,i=t.chartArea,s=(i.top,i.bottom),l=i.left,h=i.right,u=t.scales;u.x,u.y,o.save(),r.myChart.ctx.beginPath(),r.myChart.ctx.strokeStyle=r.colors.MODERATE,r.myChart.ctx.lineWidth=r.lineWidthValues.NOW_INDICATOR_LINE;var c=(f=n.datasets[0].placeLine.split(":").map(Number),m=2,function(t){if(Array.isArray(t))return t}(f)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var a,o,n,i,s=[],l=!0,h=!1;try{if(n=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=n.call(r)).done)&&(s.push(a.value),s.length!==e);l=!0);}catch(t){h=!0,o=t}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(h)throw o}}return s}}(f,m)||j(f,m)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=(60*c[0]+c[1])/1440*(h-l);n.datasets[0].placeLineInPixels=d+l,r.myChart.ctx.moveTo(d+l,1),r.myChart.ctx.lineTo(d+l,s),r.myChart.ctx.stroke(),r.myChart.ctx.restore(),r.myChart.ctx.font="normal 23px Arial",r.myChart.ctx.textBaseline="middle",r.myChart.ctx.fillStyle=r.colors.MODERATE,r.myChart.ctx.fillText(r.lineIndicatorText,d+20,s+70)}var f,m}}),X(this,"fadeChartPlugin",{afterDatasetsDraw:function(t,e,a){t.ctx,t.canvas,t.data;var o=t.chartArea,n=(o.top,o.bottom),i=(o.left,o.right),s=(o.width,o.height,t.scales);if(s.x,s.y,r.isChartClicked){var l=t.ctx;t.scales.y,t.scales.x,l.save(),l.fillStyle=r.colors.FADE_CHART_ONCLICK,l.fillRect(2,2,i,n-2),l.restore()}}}),X(this,"hoverCursorValuesXYPlugin",{afterEvent:function(t,e){t.ctx,t.canvas,t.data;var a=t.chartArea,o=(a.top,a.bottom,a.left,a.right,a.width,a.height,t.scales);o.x,o.y,e.inChartArea?(r.xHoverCoor=e.event.x,r.yHoverCoor=e.event.y):(r.xHoverCoor=void 0,r.yHoverCoor=void 0),e.changed=!0}}),X(this,"clickOnChartEnableHoverPlugin",{afterEvent:function(t,e){var a=e.event.x;if(e.event.y,"click"===e.event.type){t.ctx,t.data;for(var o=t.chartArea,n=(o.top,o.bottom,o.left,o.right,t.scales),i=(n.x,n.y,0);i<t._metasets[0].data.length;i++){var s=t._metasets[0].data[i].x-8,l=t._metasets[0].data[i].x+8;if(a>=s&&a<=l){if(!0===r.isChartClicked)return void(r.isChartClicked=!1);r.isChartClicked=!0;break}}}}}),X(this,"lineColorChangeOnThresholdPlugin",{afterLayout:function(t){var e=t.ctx;e.save();var a=t.scales.y,o=e.createLinearGradient(0,a.top,0,a.bottom);o.addColorStop(0,r.colors.HIGH),o.addColorStop(r.getThreshold(r.thresholds.HIGH-r.thresholds.ADJUSTABLE_MIN,a.max-r.thresholds.ADJUSTABLE_MIN),r.colors.HIGH),o.addColorStop(r.getThreshold(r.thresholds.HIGH-.5-r.thresholds.ADJUSTABLE_MIN,a.max-r.thresholds.ADJUSTABLE_MIN),r.colors.MODERATE),o.addColorStop(r.getThreshold(r.thresholds.MODERATE-r.thresholds.ADJUSTABLE_MIN,a.max-r.thresholds.ADJUSTABLE_MIN),r.colors.MODERATE),o.addColorStop(r.getThreshold(r.thresholds.MODERATE-.5-r.thresholds.ADJUSTABLE_MIN,a.max-r.thresholds.ADJUSTABLE_MIN),r.colors.LOW),o.addColorStop(r.getThreshold(r.thresholds.LOW-r.thresholds.ADJUSTABLE_MIN,a.max-r.thresholds.ADJUSTABLE_MIN),r.colors.LOW),o.addColorStop(r.getThreshold(r.thresholds.LOW-r.thresholds.ADJUSTABLE_MIN,a.max-r.thresholds.ADJUSTABLE_MIN),r.colors.MIN),o.addColorStop(1,r.colors.MIN),t.data.datasets[0].borderColor=o,e.restore()}}),X(this,"customXAxisLabelColorPlugin",{beforeDraw:function(t,e,a){var o=t.scales.x,n=o.top,i=(o.bottom,t.chartArea.left),s=t.chartArea.right,l=t.ctx;l.fillStyle=r.colors.X_AXIS_LABELS,l.fillRect(0,n,s+i,50)}}),X(this,"noDataTextPlugin",{afterDraw:function(t,e,a){var o,n=!1,i=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=j(t))){r&&(t=r);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,n=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw n}}}}(t.data.datasets);try{for(i.s();!(o=i.n()).done;){var s=o.value;if(s.data.length>0&&s.data.some((function(t){return 0!==t}))){n=!0;break}}}catch(t){i.e(t)}finally{i.f()}if(!n){var l=t.chartArea,h=l.left,u=l.top,c=l.right,d=l.bottom,f=t.ctx,m=(t.scales.x,(h+c)/2),y=(u+d)/2;f.save(),f.textAlign="center",f.font="40px Arial",f.fillStyle="black",f.textBaseline="middle",f.fillText(r.noDataText,m,y),f.restore()}}}),this.colors={MIN:"rgb(255, 197, 88)",LOW:"rgb(0, 185, 255)",MODERATE:"rgb(144, 112, 255)",HIGH:"rgb(38, 203, 168)",X_AXIS_LABELS:"rgb(237, 239, 240)",HOVER_RECTANGLE:"rgba(237, 239, 240,0.3)",FADE_CHART_ONCLICK:"rgba(255, 255, 255, 0.7)"},this.lineWidthValues={NOW_INDICATOR_LINE:3,HOVER_LINE:2,CHART_LINE:2,BORDER_LINE:1},this.myChart,this.xHoverCoor,this.yHoverCoor,this.isChartClicked=!1,this.chartCanvas=e,this.heartRateData=[],this.hourFormat=!0,this.maxValue=220,this.lineIndicator=!1,this.lineIndicatorText="NOW",this.noDataText="NO DATA",this.connectDuration=10,this.connectAllPoints=!1,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:94,MODERATE:115,HIGH:153,MAX:220},this.initializeChart()}var e,r;return e=t,(r=[{key:"initializeChart",value:function(){var t=this,e={labels:[],datasets:[{label:"",data:[],tension:.1,pointRadius:0,pointHoverRadius:0,borderWidth:this.lineWidthValues.CHART_LINE,spanGaps:!1,placeLine:"00:00",placeLineInPixels:0}]},r={type:"line",data:e,options:{layout:{padding:{left:20,bottom:50}},responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"hour",autoSkip:!1},min:new Date("2024-01-01T00:00:00"),max:new Date("2024-01-02T00:00:00"),display:!0,grid:{drawOnChartArea:!1,display:!1,drawBorder:!1},border:{display:!1},ticks:{offset:!1,callback:function(e,r,a){switch(r){case 0:return t.hourFormat?"12:00AM":"00:00";case 6:return t.hourFormat?"06:00AM":"06:00";case 12:return t.hourFormat?"12:00PM":"12:00";case 18:return t.hourFormat?"06:00PM":"18:00";case 24:return t.hourFormat?"11:59PM":"23:59";default:return""}},maxRotation:0,minRotation:0,color:"black",padding:8,font:{weight:"normal",size:20}}},y:{min:this.thresholds.ADJUSTABLE_MIN,max:this.thresholds.MAX,border:{display:!1},ticks:{stepSize:1,maxTicksLimit:2*this.thresholds.MAX,color:"black",font:{weight:"bold",size:20},callback:function(r,a){if(0!==e.datasets[0].data.length)return r===t.thresholds.LOW||r===t.thresholds.MODERATE||r===t.thresholds.HIGH?r:void 0},grid:{color:"red"},gridLines:{drawBorder:!1}}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.customLineBorderPlugin,this.nowIndicatorLinePlugin,this.hoverCursorValuesXYPlugin,this.fadeChartPlugin,this.hoverLineAndTextPlugin,this.clickOnChartEnableHoverPlugin,this.lineColorChangeOnThresholdPlugin,this.customXAxisLabelColorPlugin,this.noDataTextPlugin]};this.myChart=new Chart(this.chartCanvas,r)}},{key:"showChart",value:function(){this.sortHeartRateDataByTime(),this.updateChartArea(),this.renderChart(),console.log("Chart is rendered!")}},{key:"renderChart",value:function(){this.myChart.data.datasets[0].data=[];for(var t=0;t<this.heartRateData.length;t++){if(this.myChart.data.datasets[0].data.push({x:this.heartRateData[t].time,y:this.heartRateData[t].hr}),t+1<this.heartRateData.length){var e=(this.heartRateData[t+1].time-this.heartRateData[t].time)/6e4;!1===this.connectAllPoints&&e>this.connectDuration&&this.myChart.data.datasets[0].data.push({x:new Date(this.heartRateData[t].time.getTime()+6e4),y:null})}this.moveLineToLatest(this.heartRateData[this.heartRateData.length-1].time)}this.myChart.update()}},{key:"updateChartArea",value:function(){if(0!==this.heartRateData.length){var t=Math.min.apply(Math,function(t){if(Array.isArray(t))return W(t)}(e=this.heartRateData.map((function(t){return t.hr})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());t<=20?(this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0):(this.thresholds.ADJUSTABLE_MIN=t-20,this.thresholds.ADJUSTABLE_MIN>this.thresholds.LOW&&(this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW),this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN)}else this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0;var e}},{key:"addDataToChart",value:function(t,e){if(""===t||""===e||isNaN(t))alert("Please enter correct values.");else if(parseInt(t)>this.thresholds.MAX)alert("Input exceeds max value. Please enter correct values.");else if(parseInt(t)<this.thresholds.MIN)alert("Input is below minimum value. Please enter correct values.");else{var r={hr:parseInt(t),time:new Date("2024-01-01T".concat(e))};this.heartRateData.push(r)}}},{key:"setChartData",value:function(t){Array.isArray(t)&&0!==t.length?(this.heartRateData=[],this.myChart&&(this.myChart.destroy(),this.initializeChart()),t.forEach((function(t){var e=parseInt(t.hr),r=new Date("2024-01-01T".concat(t.time));t.hr=e,t.time=r})),this.heartRateData=t):alert("Heart rate data is empty or not an array.")}},{key:"setMaxValue",value:function(t){t>=this.thresholds.HIGH?(this.myChart.options.scales.y.max=t,this.thresholds.MAX=t,this.myChart.update()):alert("Error value. Max value should be higher than HIGH threshold")}},{key:"setFormat",value:function(t){"12HR"===t||"24HR"===t?(this.hourFormat="12HR"===t,this.myChart.update()):alert("Error value. Values accepted are only 12HR and 24HR")}},{key:"deleteData",value:function(t){t>=this.heartRateData.length?alert("Error value. Can delete index from length of list value"):this.heartRateData.splice(t,1)}},{key:"moveLine",value:function(t){/^([01]\d|2[0-3]):([0-5]\d)$/.test(t)?0===this.heartRateData.length?alert("No data in chart."):(this.myChart.data.datasets[0].placeLine=t,this.myChart.update()):alert("Invalid time format. Please use military time format (HH:mm).")}},{key:"setThresholds",value:function(t,e,r){if(""===t||""===e||""===r)alert("Please enter correct values.");else{var a=parseInt(t),o=parseInt(e),n=parseInt(r);!isNaN(a)&&!isNaN(o)&&!isNaN(n)&&a<=o&&o<=n?(this.thresholds.LOW=a,this.thresholds.MODERATE=o,this.thresholds.HIGH=n,this.updateChartArea(),this.myChart.update()):alert("Please enter valid threshold values.")}}},{key:"setTimeLineIndicatorToggle",value:function(t){"boolean"==typeof t&&(this.lineIndicator=!!t,this.myChart.update())}},{key:"setLineIndicator",value:function(t){this.lineIndicatorText=t,this.myChart.update()}},{key:"clearChart",value:function(){var t=document.getElementById(this.chartCanvas);Chart.getChart(t),this.heartRateData=[]}},{key:"setConnectDuration",value:function(t){var e=parseInt(t,10);!isNaN(e)&&e>=1&&e<=1440?(this.connectDuration=e,this.myChart.update()):alert("Please enter a valid duration (minimum 1 minute).")}},{key:"setConnectAllPoints",value:function(t){"boolean"==typeof t?(this.connectAllPoints=t,this.myChart.update()):alert("Invalid parameter. Please provide a boolean value.")}},{key:"setNoDataText",value:function(t){""===t?alert("Error value. Please input something."):(this.noDataText=t,this.myChart.update())}},{key:"generateRandomHRArray",value:function(t,e,r,a){if(this.heartRateData.length>0){var o=this.heartRateData[this.heartRateData.length-1].time,n=o.getHours(),i=o.getMinutes(),s=o.getSeconds();(a=a||new Date("2024-01-01T00:00:00")).setHours(n,i,s)}else a=a||new Date("2024-01-01T00:00:00");for(var l=0;l<t;l++){var h=Math.floor(Math.random()*(r-e+1))+e;this.heartRateData.push({hr:h,time:new Date(a)}),a.setMinutes(a.getMinutes()+1)}}},{key:"sortHeartRateDataByTime",value:function(){this.heartRateData.sort((function(t,e){return t.time.getTime()-e.time.getTime()})),this.heartRateData=this.heartRateData.filter((function(t){var e=t.time.getTime(),r=new Date("2024-01-01T00:00:00").getTime(),a=new Date("2024-01-01T23:59:59").getTime();return e>=r&&e<=a}))}},{key:"moveLineToLatest",value:function(t){var e=new Date(t),r=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0");this.myChart.data.datasets[0].placeLine="".concat(r,":").concat(a)}},{key:"getThreshold",value:function(t,e){return 1-t/e}},{key:"formatDate",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}).format(t)}},{key:"formatDateTimeWithSeconds",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}},{key:"formatDateTime",value:function(t){return t.toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}},{key:"saveDataToLocalStorage",value:function(){localStorage.setItem("heartRateData",JSON.stringify(this.heartRateData)),localStorage.setItem("thresholds",JSON.stringify(this.thresholds)),localStorage.setItem("hourFormat",JSON.stringify(this.hourFormat)),localStorage.setItem("maxValue",JSON.stringify(this.thresholds.MAX)),localStorage.setItem("lineIndicator",JSON.stringify(this.lineIndicator)),localStorage.setItem("lineIndicatorText",JSON.stringify(this.lineIndicatorText)),localStorage.setItem("connectDuration",JSON.stringify(this.connectDuration)),localStorage.setItem("connectAllPoints",JSON.stringify(this.connectAllPoints)),localStorage.setItem("noDataText",JSON.stringify(this.noDataText))}}])&&J(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function q(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,$(a.key),a)}}function Y(t,e,r){return e&&q(t.prototype,e),r&&q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $(t){var e=function(t,e){if("object"!=z(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=z(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:String(e)}const Q=Y((function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hr=e,this.time=r}));function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function tt(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,et(a.key),a)}}function et(t){var e=function(t,e){if("object"!=K(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=K(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==K(e)?e:String(e)}const rt=function(){function t(e){var r,a,o,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o={afterLayout:function(t){var e=t.ctx;e.save();var r=t.scales.y,a=e.createLinearGradient(0,r.top,0,r.bottom);a.addColorStop(0,n.colors.HIGH),a.addColorStop(n.getThreshold(n.thresholds.HIGH-n.thresholds.ADJUSTABLE_MIN,r.max-n.thresholds.ADJUSTABLE_MIN),n.colors.HIGH),a.addColorStop(n.getThreshold(n.thresholds.HIGH-.5-n.thresholds.ADJUSTABLE_MIN,r.max-n.thresholds.ADJUSTABLE_MIN),n.colors.MODERATE),a.addColorStop(n.getThreshold(n.thresholds.MODERATE-n.thresholds.ADJUSTABLE_MIN,r.max-n.thresholds.ADJUSTABLE_MIN),n.colors.MODERATE),a.addColorStop(n.getThreshold(n.thresholds.MODERATE-.5-n.thresholds.ADJUSTABLE_MIN,r.max-n.thresholds.ADJUSTABLE_MIN),n.colors.LOW),a.addColorStop(n.getThreshold(n.thresholds.LOW-n.thresholds.ADJUSTABLE_MIN,r.max-n.thresholds.ADJUSTABLE_MIN),n.colors.LOW),a.addColorStop(n.getThreshold(n.thresholds.LOW-n.thresholds.ADJUSTABLE_MIN,r.max-n.thresholds.ADJUSTABLE_MIN),n.colors.MIN),a.addColorStop(1,n.colors.MIN),t.data.datasets[0].borderColor=a,e.restore()}},(a=et(a="lineColorChangeOnThresholdPlugin"))in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,this.colors={MIN:"rgb(255, 197, 88)",LOW:"rgb(0, 185, 255)",MODERATE:"rgb(144, 112, 255)",HIGH:"rgb(38, 203, 168)"},this.myChart,this.chartCanvas=e,this.heartRateData=[],this.maxValue=220,this.connectDuration=10,this.connectAllPoints=!1,this.thresholds={MIN:0,ADJUSTABLE_MIN:0,LOW:94,MODERATE:115,HIGH:153,MAX:220},this.initializeChart()}var e,r;return e=t,(r=[{key:"initializeChart",value:function(){var t={type:"line",data:{labels:[],datasets:[{label:"",data:[],tension:.1,pointRadius:0,pointHoverRadius:0,borderWidth:2,spanGaps:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"hour"},min:new Date("2024-01-01T00:00:00"),max:new Date("2024-01-02T00:00:00"),display:!1},y:{min:this.thresholds.ADJUSTABLE_MIN,max:this.thresholds.MAX,border:{display:!1},display:!1}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}},plugins:[this.lineColorChangeOnThresholdPlugin]};this.myChart=new Chart(this.chartCanvas,t)}},{key:"showChart",value:function(){this.sortHeartRateDataByTime(),this.updateChartArea(),this.renderChart(),console.log("Chart is rendered!")}},{key:"renderChart",value:function(){this.myChart.data.datasets[0].data=[];for(var t=0;t<this.heartRateData.length;t++)if(this.myChart.data.datasets[0].data.push({x:this.heartRateData[t].time,y:this.heartRateData[t].hr}),t+1<this.heartRateData.length){var e=(this.heartRateData[t+1].time-this.heartRateData[t].time)/6e4;!1===this.connectAllPoints&&e>this.connectDuration&&this.myChart.data.datasets[0].data.push({x:new Date(this.heartRateData[t].time.getTime()+6e4),y:null})}this.myChart.update()}},{key:"updateChartArea",value:function(){if(0!==this.heartRateData.length){var t=Math.min.apply(Math,function(t){if(Array.isArray(t))return Z(t)}(e=this.heartRateData.map((function(t){return t.hr})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return Z(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());t<=20?(this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0):(this.thresholds.ADJUSTABLE_MIN=t-20,this.thresholds.ADJUSTABLE_MIN>this.thresholds.LOW&&(this.thresholds.ADJUSTABLE_MIN=this.thresholds.LOW),this.myChart.options.scales.y.min=this.thresholds.ADJUSTABLE_MIN)}else this.thresholds.ADJUSTABLE_MIN=0,this.myChart.options.scales.y.min=0;var e}},{key:"addDataToChart",value:function(t,e){if(""===t||""===e||isNaN(t))alert("Please enter correct values.");else if(parseInt(t)>this.thresholds.MAX)alert("Input exceeds max value. Please enter correct values.");else if(parseInt(t)<this.thresholds.MIN)alert("Input is below minimum value. Please enter correct values.");else{var r={hr:parseInt(t),time:new Date("2024-01-01T".concat(e))};this.heartRateData.push(r)}}},{key:"setChartData",value:function(t){Array.isArray(t)&&0!==t.length?(this.heartRateData=[],this.myChart&&(this.myChart.destroy(),this.initializeChart()),t.forEach((function(t){var e=parseInt(t.hr),r=new Date("2024-01-01T".concat(t.time));t.hr=e,t.time=r})),this.heartRateData=t):alert("Heart rate data is empty or not an array.")}},{key:"setMaxValue",value:function(t){t>=this.thresholds.HIGH?(this.myChart.options.scales.y.max=t,this.thresholds.MAX=t,this.myChart.update()):alert("Error value. Max value should be higher than HIGH threshold")}},{key:"setThresholds",value:function(t,e,r){if(""===t||""===e||""===r)alert("Please enter correct values.");else{var a=parseInt(t),o=parseInt(e),n=parseInt(r);!isNaN(a)&&!isNaN(o)&&!isNaN(n)&&a<=o&&o<=n?(this.thresholds.LOW=a,this.thresholds.MODERATE=o,this.thresholds.HIGH=n,this.updateChartArea(),this.myChart.update()):alert("Please enter valid threshold values.")}}},{key:"clearChart",value:function(){var t=document.getElementById(this.chartCanvas);Chart.getChart(t),this.heartRateData=[]}},{key:"deleteData",value:function(t){t>=this.heartRateData.length?alert("Error value. Can delete index from length of list value"):this.heartRateData.splice(t,1)}},{key:"setConnectDuration",value:function(t){var e=parseInt(t,10);!isNaN(e)&&e>=1&&e<=1440?(this.connectDuration=e,this.myChart.update()):alert("Please enter a valid duration (minimum 1 minute).")}},{key:"setConnectAllPoints",value:function(t){"boolean"==typeof t?(this.connectAllPoints=t,this.myChart.update()):alert("Invalid parameter. Please provide a boolean value.")}},{key:"generateRandomHRArray",value:function(t,e,r,a){if(this.heartRateData.length>0){var o=this.heartRateData[this.heartRateData.length-1].time,n=o.getHours(),i=o.getMinutes(),s=o.getSeconds();(a=a||new Date("2024-01-01T00:00:00")).setHours(n,i,s)}else a=a||new Date("2024-01-01T00:00:00");for(var l=0;l<t;l++){var h=Math.floor(Math.random()*(r-e+1))+e;this.heartRateData.push({hr:h,time:new Date(a)}),a.setMinutes(a.getMinutes()+1)}}},{key:"sortHeartRateDataByTime",value:function(){this.heartRateData.sort((function(t,e){return t.time.getTime()-e.time.getTime()})),this.heartRateData=this.heartRateData.filter((function(t){var e=t.time.getTime(),r=new Date("2024-01-01T00:00:00").getTime(),a=new Date("2024-01-01T23:59:59").getTime();return e>=r&&e<=a}))}},{key:"getThreshold",value:function(t,e){return 1-t/e}},{key:"formatDate",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}).format(t)}},{key:"formatDateTimeWithSeconds",value:function(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}},{key:"formatDateTime",value:function(t){return t.toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}}])&&tt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ot(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,nt(a.key),a)}}function nt(t){var e=function(t,e){if("object"!=at(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=at(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==at(e)?e:String(e)}const it=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startTime=e,this.heartRate=r}var e,r;return e=t,(r=[{key:"heartRate",get:function(){return this._heartRate},set:function(t){this._heartRate=t}},{key:"startTime",get:function(){return this._startTime},set:function(t){this._startTime=t}}])&&ot(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();void 0!==(t=r.hmd(t)).exports?t.exports={TimeDisplayFormat:a,TimeInterval:o,StepCountInterval:l,StepCountBarChart:f,SleepQuality:m,SleepQualityInterval:b,SleepQualityBarChart:L,FitnessAgeBarChart:_,HeartRateLineDataModel:U,HeartRateLineChart:V,TileHeartRateLineDataModel:Q,TileHeartRateLineChart:rt,ChartLanguage:A,HeartRateInterval:it}:(window.TimeDisplayFormat=a,window.TimeInterval=o,window.StepCountInterval=l,window.StepCountBarChart=f,window.SleepQuality=m,window.SleepQualityInterval=b,window.SleepQualityBarChart=L,window.FitnessAgeBarChart=_,window.HeartRateLineDataModel=U,window.HeartRateLineChart=V,window.TileHeartRateLineDataModel=Q,window.TileHeartRateLineChart=rt,window.ChartLanguage=A,window.HeartRateInterval=it)}},e={};function r(a){var o=e[a];if(void 0!==o)return o.exports;var n=e[a]={id:a,loaded:!1,exports:{}};return t[a](n,n.exports,r),n.loaded=!0,n.exports}return r.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(671)})()));